clear
clc

%{
syms u v tetaZ w tetaY tetaX

Tc01 = [cos(tetaY), 0, sin(tetaY); 0, 1, 0; -sin(tetaY), 0, cos(tetaY)];
Tc10 = Tc01.';
Tc12 = [cos(tetaZ), -sin(tetaZ), 0; sin(tetaZ), cos(tetaZ), 0; 0, 0, 1];
Tc21 = Tc12.';
Tc23 = [1, 0, 0; 0, cos(tetaX), -sin(tetaX); 0, sin(tetaX), cos(tetaX)];
Tc32 = Tc23.';

X0 = [0; y; z];
x0 = Tc01*Tc12*Tc23*[0; y; z];
p0 = [u; v; w] + x0 - X0;
ux = p0(1);
uy = p0(2);
uz = p0(3);

uxAprox = u + y*(sin(tetaX)*tetaY - cos(tetaX)*tetaZ) + z*(cos(tetaX)*tetaY + sin(tetaX)*tetaZ);
uyAprox = v + y*(cos(tetaX) - 1) - z*sin(tetaX);
uzAprox = w + y*sin(tetaX) + z*(cos(tetaX) - 1);
uxDisp = u + y*(sin(tetaX)*sin(tetaY) - cos(tetaX)*cos(tetaY)*sin(tetaZ)) + z*(cos(tetaX)*sin(tetaY) + cos(tetaY)*sin(tetaX)*sin(tetaZ));
uyDisp = v - y + y*cos(tetaX)*cos(tetaZ) - z*cos(tetaZ)*sin(tetaX);
uzDisp = w - z + y*(cos(tetaY)*sin(tetaX) + cos(tetaX)*sin(tetaY)*sin(tetaZ)) + z*(cos(tetaX)*cos(tetaY) - sin(tetaX)*sin(tetaY)*sin(tetaZ));
erroX = simplify(uxDisp - uxAprox);
erroY = simplify(uyDisp - uyAprox);
erroZ = simplify(uzDisp - uzAprox);
ad = 1;
%ok!
%}

%Verificação das derivadas: ok!
syms x y z u(x) v(x) tetaZ(x) w(x) tetaY(x) tetaX(x)
syms E ks G R

du_dx = diff(u,x);
dv_dx = diff(v,x);
dtetaZ_dx = diff(tetaZ,x);
dw_dx = diff(w,x);
dtetaY_dx = diff(tetaY,x);
dtetaX_dx = diff(tetaX,x);

uxAprox = u + y*(sin(tetaX)*tetaY - cos(tetaX)*tetaZ) + z*(cos(tetaX)*tetaY + sin(tetaX)*tetaZ);
uyAprox = v + y*(cos(tetaX) - 1) - z*sin(tetaX);
uzAprox = w + y*sin(tetaX) + z*(cos(tetaX) - 1);

dux_dx = du_dx +...
    y*((cos(tetaX)*dtetaX_dx*tetaY + sin(tetaX)*dtetaY_dx) - (-sin(tetaX)*dtetaX_dx*tetaZ + cos(tetaX)*dtetaZ_dx)) +...
    z*((-sin(tetaX)*dtetaX_dx*tetaY + cos(tetaX)*dtetaY_dx) + (cos(tetaX)*dtetaX_dx*tetaZ + sin(tetaX)*dtetaZ_dx));
%{
dux_dx_ref = diff(uxAprox,x);
disp('ping_dux_dx')
erro = simplify(dux_dx_ref - dux_dx);
disp('pong_dux_dx')
%}

dux_dy = sin(tetaX)*tetaY - cos(tetaX)*tetaZ;
%{
dux_dy_ref = diff(uxAprox,y);
disp('ping_dux_dy')
erro = simplify(dux_dy_ref - dux_dy);
disp('pong_dux_dy')
%}

dux_dz = cos(tetaX)*tetaY + sin(tetaX)*tetaZ;
%{
dux_dz_ref = diff(uxAprox,z);
disp('ping_dux_dz')
erro = simplify(dux_dz_ref - dux_dz);
disp('pong_dux_dz')
%}

duy_dx = dv_dx + y*(-sin(tetaX)*dtetaX_dx) - z*cos(tetaX)*dtetaX_dx;
%{
duy_dx_ref = diff(uyAprox,x);
disp('ping_duy_dx')
erro = simplify(duy_dx_ref - duy_dx);
disp('pong_duy_dx')
%}

duy_dy = -1 + cos(tetaX);
%{
duy_dy_ref = diff(uyAprox,y);
disp('ping_duy_dy')
erro = simplify(duy_dy_ref - duy_dy);
disp('pong_duy_dy')
%}

duy_dz = -sin(tetaX);
%{
duy_dz_ref = diff(uyAprox,z);
disp('ping_duy_dz')
erro = simplify(duy_dz_ref - duy_dz);
disp('pong_duy_dz')
%}

duz_dx = dw_dx + (y*cos(tetaX) - z*sin(tetaX))*dtetaX_dx;
%{
duz_dx_ref = diff(uzAprox,x);
disp('ping_duz_dx')
erro = simplify(duz_dx_ref - duz_dx);
disp('pong_duz_dx')
%}

duz_dy = sin(tetaX);
%{
duz_dy_ref = diff(uzAprox,y);
disp('ping_duz_dy')
erro = simplify(duz_dy_ref - duz_dy);
disp('pong_duz_dy')
%}

duz_dz = -1 + cos(tetaX);
%{
duz_dz_ref = diff(uzAprox,z);
disp('ping_duz_dz')
erro = simplify(duz_dz_ref - duz_dz);
disp('pong_duz_dz')
%}

%{
epsilon_xx = dux_dx + 0.5*(dux_dx*dux_dx + duy_dx*duy_dx + duz_dx*duz_dx);
epsilon_xx = simplify(epsilon_xx);
epsilon_xy = 0.5*(duy_dx + dux_dy + dux_dx*dux_dy + duy_dx*duy_dy + duz_dx*duz_dy);
epsilon_xy = simplify(epsilon_xy);
epsilon_xz = 0.5*(duz_dx + dux_dz + dux_dx*dux_dz + duy_dx*duy_dz + duz_dx*duz_dz);
epsilon_xz = simplify(epsilon_xz);

psi_x_y_z = E*epsilon_xx^2 + 4*ks*G*(epsilon_xy^2 + epsilon_xz^2);
disp('ping_xyz')
psi_x_y_z = simplify(psi_x_y_z);
disp('pong_xyz')

syms r fi
psi_x_r_fi = subs(psi_x_y_z, [y, z], [r*cos(fi), r*sin(fi)]);
disp('ping_x_r_fi')
psi_x_r_fi = simplify(psi_x_r_fi);
disp('pong_x_r_fi')
Psi_x_fi = int(psi_x_r_fi*r, r, 0, R);
disp('ping_x_fi')
Psi_x_fi = simplify(Psi_x_fi);
disp('pong_x_fi')
Psi_x = int(Psi_x_fi, fi, 0, 2*pi);
disp('ping_x')
Psi_x = simplify(Psi_x);
disp('pong_x')
%}

Psi_x_disp =...
    pi*E*R^2*...
    (du_dx^2 + du_dx^3 + (du_dx^4)/4 + (dv_dx^4)/4 + (dw_dx^4)/4 +...
     du_dx*dv_dx^2 + du_dx*dw_dx^2 +...
     (du_dx^2*dv_dx^2)/2 + (du_dx^2*dw_dx^2)/2 + (dv_dx^2*dw_dx^2)/2) +...
    pi*E*R^4*...
    ((dtetaY_dx^2)/4 + (dtetaZ_dx^2)/4 +...
     (tetaY^2*dtetaX_dx^2)/4 + (tetaZ^2*dtetaX_dx^2)/4 +...
     (dtetaX_dx^2*du_dx)/2 + (3*dtetaY_dx^2*du_dx)/4 + (3*dtetaZ_dx^2*du_dx)/4 +...
     (dtetaX_dx^2*du_dx^2)/4 + (3*dtetaY_dx^2*du_dx^2)/8 + (3*dtetaZ_dx^2*du_dx^2)/8 +...
     (dtetaX_dx^2*dv_dx^2)/2 + (dtetaY_dx^2*dv_dx^2)/8 + (dtetaZ_dx^2*dv_dx^2)/8 +...
     (dtetaX_dx^2*dw_dx^2)/2 + (dtetaY_dx^2*dw_dx^2)/8 + (dtetaZ_dx^2*dw_dx^2)/8 -...
     (dtetaX_dx*dtetaY_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*dw_dx)/2 -...
     (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
     (3*tetaY^2*dtetaX_dx^2*du_dx^2)/8 + (3*tetaZ^2*dtetaX_dx^2*du_dx^2)/8 +...
     (tetaY^2*dtetaX_dx^2*dv_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dv_dx^2)/8 +...
     (tetaY^2*dtetaX_dx^2*dw_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dw_dx^2)/8 -...
     (tetaZ*dtetaX_dx^2*dv_dx)/2 + (tetaY*dtetaX_dx^2*dw_dx)/2 +...
     (3*tetaY^2*dtetaX_dx^2*du_dx)/4 + (3*tetaZ^2*dtetaX_dx^2*du_dx)/4 -...
     (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx^2)/4 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx^2)/4 -...
     (tetaY*dtetaX_dx*dtetaZ_dx*dv_dx^2)/4 + (tetaZ*dtetaX_dx*dtetaY_dx*dv_dx^2)/4 -...
     (tetaZ*dtetaX_dx^2*du_dx*dv_dx)/2 - (tetaY*dtetaX_dx*dtetaZ_dx*dw_dx^2)/4 +...
     (tetaZ*dtetaX_dx*dtetaY_dx*dw_dx^2)/4 + (tetaY*dtetaX_dx^2*du_dx*dw_dx)/2 -...
     (dtetaX_dx*dtetaY_dx*du_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*du_dx*dw_dx)/2 -...
     (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx)/2 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx)/2) +...
    pi*E*R^6*...
    ((dtetaX_dx^4)/12 + (dtetaY_dx^4)/32 + (dtetaZ_dx^4)/32 +...
     (tetaY^2*dtetaX_dx^4)/12 + (tetaZ^2*dtetaX_dx^4)/12 +...
     (tetaY^4*dtetaX_dx^4)/32 + (tetaZ^4*dtetaX_dx^4)/32 +...
     (dtetaX_dx^2*dtetaY_dx^2)/12 + (dtetaX_dx^2*dtetaZ_dx^2)/12 +...
     (dtetaY_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (3*tetaY^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (3*tetaZ^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (tetaZ^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*tetaZ^2*dtetaX_dx^4)/16 -...
     (tetaY*dtetaX_dx^3*dtetaZ_dx)/6 - (tetaY*dtetaX_dx*dtetaZ_dx^3)/8 +...
     (tetaZ*dtetaX_dx^3*dtetaY_dx)/6 + (tetaZ*dtetaX_dx*dtetaY_dx^3)/8 -...
     (tetaY^3*dtetaX_dx^3*dtetaZ_dx)/8 + (tetaZ^3*dtetaX_dx^3*dtetaY_dx)/8 -...
     (tetaY*dtetaX_dx*dtetaY_dx^2*dtetaZ_dx)/8 + (tetaZ*dtetaX_dx*dtetaY_dx*dtetaZ_dx^2)/8 +...
     (tetaY^2*tetaZ*dtetaX_dx^3*dtetaY_dx)/8 - (tetaY*tetaZ^2*dtetaX_dx^3*dtetaZ_dx)/8 -...
     (tetaY*tetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx)/4) +...
    pi*G*R^2*ks*...
    (dv_dx^2 + dw_dx^2 + tetaY^2 + tetaZ^2 + 2*tetaY^2*du_dx + 2*tetaZ^2*du_dx +...
     tetaY^2*du_dx^2 + tetaZ^2*du_dx^2 - 2*tetaZ*dv_dx + 2*tetaY*dw_dx -...
     2*tetaZ*du_dx*dv_dx + 2*tetaY*du_dx*dw_dx) +...
    pi*G*R^4*ks*...
    ((dtetaX_dx^2)/2 + (tetaY^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaY_dx^2)/4 +...
     (tetaZ^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaZ_dx^2)/4 + (tetaZ^2*dtetaY_dx^2)/4 +...
     (tetaY^4*dtetaX_dx^2)/4 + (tetaZ^2*dtetaZ_dx^2)/4 + (tetaZ^4*dtetaX_dx^2)/4 -...
     (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
     (tetaY^2*tetaZ^2*dtetaX_dx^2)/2 - (tetaY^3*dtetaX_dx*dtetaZ_dx)/2 +...
     (tetaZ^3*dtetaX_dx*dtetaY_dx)/2 + (tetaY^2*tetaZ*dtetaX_dx*dtetaY_dx)/2 - (tetaY*tetaZ^2*dtetaX_dx*dtetaZ_dx)/2);
%{
disp('ping_disp')
erroDisp = simplify(Psi_x - Psi_x_disp);
disp('pong_disp')
%}

%{
Psi_x_linear = pi*R^2*E*...
    (du_dx^2) +...
    pi*R^4*E*...
    ((1/4)*(dtetaY_dx^2 + dtetaZ_dx^2)) +...
    pi*R^2*ks*G*...
    ((tetaZ - dv_dx)^2 + (tetaY + dw_dx)^2) +...
    pi*R^4*ks*G*...
    ((1/2)*...
    (dtetaX_dx^2));

Psi_x_nlinear =...
    pi*E*R^2*...
    (du_dx^3 + (du_dx^4)/4 + (dv_dx^4)/4 + (dw_dx^4)/4 +...
     du_dx*dv_dx^2 + du_dx*dw_dx^2 +...
     (du_dx^2*dv_dx^2)/2 + (du_dx^2*dw_dx^2)/2 + (dv_dx^2*dw_dx^2)/2) +...
    pi*E*R^4*...
    ((tetaY^2*dtetaX_dx^2)/4 + (tetaZ^2*dtetaX_dx^2)/4 +...
     (dtetaX_dx^2*du_dx)/2 + (3*dtetaY_dx^2*du_dx)/4 + (3*dtetaZ_dx^2*du_dx)/4 +...
     (dtetaX_dx^2*du_dx^2)/4 + (3*dtetaY_dx^2*du_dx^2)/8 + (3*dtetaZ_dx^2*du_dx^2)/8 +...
     (dtetaX_dx^2*dv_dx^2)/2 + (dtetaY_dx^2*dv_dx^2)/8 + (dtetaZ_dx^2*dv_dx^2)/8 +...
     (dtetaX_dx^2*dw_dx^2)/2 + (dtetaY_dx^2*dw_dx^2)/8 + (dtetaZ_dx^2*dw_dx^2)/8 -...
     (dtetaX_dx*dtetaY_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*dw_dx)/2 -...
     (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
     (3*tetaY^2*dtetaX_dx^2*du_dx^2)/8 + (3*tetaZ^2*dtetaX_dx^2*du_dx^2)/8 +...
     (tetaY^2*dtetaX_dx^2*dv_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dv_dx^2)/8 +...
     (tetaY^2*dtetaX_dx^2*dw_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dw_dx^2)/8 -...
     (tetaZ*dtetaX_dx^2*dv_dx)/2 + (tetaY*dtetaX_dx^2*dw_dx)/2 +...
     (3*tetaY^2*dtetaX_dx^2*du_dx)/4 + (3*tetaZ^2*dtetaX_dx^2*du_dx)/4 -...
     (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx^2)/4 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx^2)/4 -...
     (tetaY*dtetaX_dx*dtetaZ_dx*dv_dx^2)/4 + (tetaZ*dtetaX_dx*dtetaY_dx*dv_dx^2)/4 -...
     (tetaZ*dtetaX_dx^2*du_dx*dv_dx)/2 - (tetaY*dtetaX_dx*dtetaZ_dx*dw_dx^2)/4 +...
     (tetaZ*dtetaX_dx*dtetaY_dx*dw_dx^2)/4 + (tetaY*dtetaX_dx^2*du_dx*dw_dx)/2 -...
     (dtetaX_dx*dtetaY_dx*du_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*du_dx*dw_dx)/2 -...
     (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx)/2 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx)/2) +...
    pi*E*R^6*...
    ((dtetaX_dx^4)/12 + (dtetaY_dx^4)/32 + (dtetaZ_dx^4)/32 +...
     (tetaY^2*dtetaX_dx^4)/12 + (tetaZ^2*dtetaX_dx^4)/12 +...
     (tetaY^4*dtetaX_dx^4)/32 + (tetaZ^4*dtetaX_dx^4)/32 +...
     (dtetaX_dx^2*dtetaY_dx^2)/12 + (dtetaX_dx^2*dtetaZ_dx^2)/12 +...
     (dtetaY_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (3*tetaY^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (3*tetaZ^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (tetaZ^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*tetaZ^2*dtetaX_dx^4)/16 -...
     (tetaY*dtetaX_dx^3*dtetaZ_dx)/6 - (tetaY*dtetaX_dx*dtetaZ_dx^3)/8 +...
     (tetaZ*dtetaX_dx^3*dtetaY_dx)/6 + (tetaZ*dtetaX_dx*dtetaY_dx^3)/8 -...
     (tetaY^3*dtetaX_dx^3*dtetaZ_dx)/8 + (tetaZ^3*dtetaX_dx^3*dtetaY_dx)/8 -...
     (tetaY*dtetaX_dx*dtetaY_dx^2*dtetaZ_dx)/8 + (tetaZ*dtetaX_dx*dtetaY_dx*dtetaZ_dx^2)/8 +...
     (tetaY^2*tetaZ*dtetaX_dx^3*dtetaY_dx)/8 - (tetaY*tetaZ^2*dtetaX_dx^3*dtetaZ_dx)/8 -...
     (tetaY*tetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx)/4) +...
    pi*G*R^2*ks*...
    (2*tetaY^2*du_dx + 2*tetaZ^2*du_dx +...
     tetaY^2*du_dx^2 + tetaZ^2*du_dx^2 -...
     2*tetaZ*du_dx*dv_dx + 2*tetaY*du_dx*dw_dx) +...
    pi*G*R^4*ks*...
    ((tetaY^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaY_dx^2)/4 +...
     (tetaZ^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaZ_dx^2)/4 + (tetaZ^2*dtetaY_dx^2)/4 +...
     (tetaY^4*dtetaX_dx^2)/4 + (tetaZ^2*dtetaZ_dx^2)/4 + (tetaZ^4*dtetaX_dx^2)/4 -...
     (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
     (tetaY^2*tetaZ^2*dtetaX_dx^2)/2 - (tetaY^3*dtetaX_dx*dtetaZ_dx)/2 +...
     (tetaZ^3*dtetaX_dx*dtetaY_dx)/2 + (tetaY^2*tetaZ*dtetaX_dx*dtetaY_dx)/2 -...
     (tetaY*tetaZ^2*dtetaX_dx*dtetaZ_dx)/2);
%{
disp('ping_Psi_l_nl')
erro_Psi_l_nl = simplify(Psi_x_disp - (Psi_x_linear + Psi_x_nlinear));
disp('pong_Psi_l_nl')
ad = 1;
%ok!
%}
%}

syms u1 v1 tetaZ1 w1 tetaY1 tetaX1 u2 v2 tetaZ2 w2 tetaY2 tetaX2
syms xj le

%%
%Consideração das aproximações via elementos finitos

xi = (x - xj)/le;

n1 = 1 - xi;
n2 = xi;
H1 = 1 - 3*xi^2 + 2*xi^3;
H2 = le*(xi - 2*xi^2 + xi^3);
H3 = 3*xi^2 - 2*xi^3;
H4 = le*(-xi^2 + xi^3);

dn1dx = diff(n1,x);
dn2dx = diff(n2,x);
dH1dx = diff(H1,x);
dH2dx = diff(H2,x);
dH3dx = diff(H3,x);
dH4dx = diff(H4,x);

d2H1dx2 = diff(dH1dx,x);
d2H2dx2 = diff(dH2dx,x);
d2H3dx2 = diff(dH3dx,x);
d2H4dx2 = diff(dH4dx,x);

clear xi
syms xi

dn1dx = simplify(subs(dn1dx,x,le*xi + xj));
dn2dx = simplify(subs(dn2dx,x,le*xi + xj));
dH1dx = simplify(subs(dH1dx,x,le*xi + xj));
dH2dx = simplify(subs(dH2dx,x,le*xi + xj));
dH3dx = simplify(subs(dH3dx,x,le*xi + xj));
dH4dx = simplify(subs(dH4dx,x,le*xi + xj));

d2H1dx2 = simplify(subs(d2H1dx2,x,le*xi + xj));
d2H2dx2 = simplify(subs(d2H2dx2,x,le*xi + xj));
d2H3dx2 = simplify(subs(d2H3dx2,x,le*xi + xj));
d2H4dx2 = simplify(subs(d2H4dx2,x,le*xi + xj));

Nu = [n1, 0, 0, 0, 0, 0, n2, 0, 0, 0, 0, 0];
Nv = ([0, H1, H2, 0, 0, 0,...
    0, H3, H4, 0, 0, 0]);
NtetaZ = ([0, dH1dx, dH2dx, 0, 0, 0,...
    0, dH3dx, dH4dx, 0, 0, 0]);
Nw = ([0, 0, 0, H1, -H2, 0,...
    0, 0, 0, H3, -H4, 0]);
NtetaY = ([0, 0, 0, -dH1dx, dH2dx, 0,...
    0, 0, 0, -dH3dx, dH4dx, 0]);
NtetaX = ([0, 0, 0, 0, 0, n1, 0, 0, 0, 0, 0, n2]);

dNu_dx = [dn1dx, 0, 0, 0, 0, 0, dn2dx, 0, 0, 0, 0, 0];
dNv_dx = ([0, dH1dx, dH2dx, 0, 0, 0,...
    0, dH3dx, dH4dx, 0, 0, 0]);
dNtetaZ_dx = ([0, d2H1dx2, d2H2dx2, 0, 0, 0,...
    0, d2H3dx2, d2H4dx2, 0, 0, 0]);
dNw_dx = ([0, 0, 0, dH1dx, -dH2dx, 0,...
    0, 0, 0, dH3dx, -dH4dx, 0]);
dNtetaY_dx = ([0, 0, 0, -d2H1dx2, d2H2dx2, 0,...
    0, 0, 0, -d2H3dx2, d2H4dx2, 0]);
dNtetaX_dx = ([0, 0, 0, 0, 0, dn1dx, 0, 0, 0, 0, 0, dn2dx]);

uj = [u1; v1; tetaZ1; w1; tetaY1; tetaX1; u2; v2; tetaZ2; w2; tetaY2; tetaX2];

u = Nu*uj;
v = Nv*uj;
tetaZ = NtetaZ*uj;
w = Nw*uj;
tetaY = NtetaY*uj;
tetaX = NtetaX*uj;

du_dx = dNu_dx*uj;
dv_dx = dNv_dx*uj;
dtetaZ_dx = dNtetaZ_dx*uj;
dw_dx = dNw_dx*uj;
dtetaY_dx = dNtetaY_dx*uj;
dtetaX_dx = dNtetaX_dx*uj;

Psi_x_linear = pi*R^2*E*...
    (du_dx^2) +...
    pi*R^4*E*...
    ((1/4)*(dtetaY_dx^2 + dtetaZ_dx^2)) +...
    pi*R^2*ks*G*...
    ((tetaZ - dv_dx)^2 + (tetaY + dw_dx)^2) +...
    pi*R^4*ks*G*...
    ((1/2)*...
    (dtetaX_dx^2));

Psi_x_nlinear =...
    pi*E*R^2*...
    (du_dx^3 + (du_dx^4)/4 + (dv_dx^4)/4 + (dw_dx^4)/4 +...
     du_dx*dv_dx^2 + du_dx*dw_dx^2 +...
     (du_dx^2*dv_dx^2)/2 + (du_dx^2*dw_dx^2)/2 + (dv_dx^2*dw_dx^2)/2) +...
    pi*E*R^4*...
    ((tetaY^2*dtetaX_dx^2)/4 + (tetaZ^2*dtetaX_dx^2)/4 +...
     (dtetaX_dx^2*du_dx)/2 + (3*dtetaY_dx^2*du_dx)/4 + (3*dtetaZ_dx^2*du_dx)/4 +...
     (dtetaX_dx^2*du_dx^2)/4 + (3*dtetaY_dx^2*du_dx^2)/8 + (3*dtetaZ_dx^2*du_dx^2)/8 +...
     (dtetaX_dx^2*dv_dx^2)/2 + (dtetaY_dx^2*dv_dx^2)/8 + (dtetaZ_dx^2*dv_dx^2)/8 +...
     (dtetaX_dx^2*dw_dx^2)/2 + (dtetaY_dx^2*dw_dx^2)/8 + (dtetaZ_dx^2*dw_dx^2)/8 -...
     (dtetaX_dx*dtetaY_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*dw_dx)/2 -...
     (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
     (3*tetaY^2*dtetaX_dx^2*du_dx^2)/8 + (3*tetaZ^2*dtetaX_dx^2*du_dx^2)/8 +...
     (tetaY^2*dtetaX_dx^2*dv_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dv_dx^2)/8 +...
     (tetaY^2*dtetaX_dx^2*dw_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dw_dx^2)/8 -...
     (tetaZ*dtetaX_dx^2*dv_dx)/2 + (tetaY*dtetaX_dx^2*dw_dx)/2 +...
     (3*tetaY^2*dtetaX_dx^2*du_dx)/4 + (3*tetaZ^2*dtetaX_dx^2*du_dx)/4 -...
     (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx^2)/4 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx^2)/4 -...
     (tetaY*dtetaX_dx*dtetaZ_dx*dv_dx^2)/4 + (tetaZ*dtetaX_dx*dtetaY_dx*dv_dx^2)/4 -...
     (tetaZ*dtetaX_dx^2*du_dx*dv_dx)/2 - (tetaY*dtetaX_dx*dtetaZ_dx*dw_dx^2)/4 +...
     (tetaZ*dtetaX_dx*dtetaY_dx*dw_dx^2)/4 + (tetaY*dtetaX_dx^2*du_dx*dw_dx)/2 -...
     (dtetaX_dx*dtetaY_dx*du_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*du_dx*dw_dx)/2 -...
     (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx)/2 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx)/2) +...
    pi*E*R^6*...
    ((dtetaX_dx^4)/12 + (dtetaY_dx^4)/32 + (dtetaZ_dx^4)/32 +...
     (tetaY^2*dtetaX_dx^4)/12 + (tetaZ^2*dtetaX_dx^4)/12 +...
     (tetaY^4*dtetaX_dx^4)/32 + (tetaZ^4*dtetaX_dx^4)/32 +...
     (dtetaX_dx^2*dtetaY_dx^2)/12 + (dtetaX_dx^2*dtetaZ_dx^2)/12 +...
     (dtetaY_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (3*tetaY^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (3*tetaZ^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (tetaZ^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*tetaZ^2*dtetaX_dx^4)/16 -...
     (tetaY*dtetaX_dx^3*dtetaZ_dx)/6 - (tetaY*dtetaX_dx*dtetaZ_dx^3)/8 +...
     (tetaZ*dtetaX_dx^3*dtetaY_dx)/6 + (tetaZ*dtetaX_dx*dtetaY_dx^3)/8 -...
     (tetaY^3*dtetaX_dx^3*dtetaZ_dx)/8 + (tetaZ^3*dtetaX_dx^3*dtetaY_dx)/8 -...
     (tetaY*dtetaX_dx*dtetaY_dx^2*dtetaZ_dx)/8 + (tetaZ*dtetaX_dx*dtetaY_dx*dtetaZ_dx^2)/8 +...
     (tetaY^2*tetaZ*dtetaX_dx^3*dtetaY_dx)/8 - (tetaY*tetaZ^2*dtetaX_dx^3*dtetaZ_dx)/8 -...
     (tetaY*tetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx)/4) +...
    pi*G*R^2*ks*...
    (2*tetaY^2*du_dx + 2*tetaZ^2*du_dx +...
     tetaY^2*du_dx^2 + tetaZ^2*du_dx^2 -...
     2*tetaZ*du_dx*dv_dx + 2*tetaY*du_dx*dw_dx) +...
    pi*G*R^4*ks*...
    ((tetaY^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaY_dx^2)/4 +...
     (tetaZ^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaZ_dx^2)/4 + (tetaZ^2*dtetaY_dx^2)/4 +...
     (tetaY^4*dtetaX_dx^2)/4 + (tetaZ^2*dtetaZ_dx^2)/4 + (tetaZ^4*dtetaX_dx^2)/4 -...
     (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
     (tetaY^2*tetaZ^2*dtetaX_dx^2)/2 - (tetaY^3*dtetaX_dx*dtetaZ_dx)/2 +...
     (tetaZ^3*dtetaX_dx*dtetaY_dx)/2 + (tetaY^2*tetaZ*dtetaX_dx*dtetaY_dx)/2 -...
     (tetaY*tetaZ^2*dtetaX_dx*dtetaZ_dx)/2);

%%
%{
U_kj_Aux =...
    pi*R^2*E*...
    2*(dNu_dx.'*dNu_dx) +...
    pi*R^4*E*...
    ((1/4)*2*(dNtetaY_dx.'*dNtetaY_dx + dNtetaZ_dx.'*dNtetaZ_dx)) +...
    pi*R^2*ks*G*...
    2*((NtetaZ.' - dNv_dx.')*(NtetaZ - dNv_dx) + (NtetaY.' + dNw_dx.')*(NtetaY + dNw_dx)) +...
    pi*R^4*ks*G*...
    ((1/2)*2*...
    (dNtetaX_dx.'*dNtetaX_dx));
%{
dPsi_x_linear_duj_ref = gradient(Psi_x_linear,uj);
disp('ping_U_kj_Aux')
erro_U_kj_Aux = simplify(dPsi_x_linear_duj_ref - U_kj_Aux*uj);
disp('pong_U_kj_Aux')
ad = 1;
%ok!
%}
%}
U_kj_Aux =...
    pi*R^2*E*...
    2*(dNu_dx.'*dNu_dx) +...
    pi*R^4*E*...
    ((1/4)*2*(dNtetaY_dx.'*dNtetaY_dx + dNtetaZ_dx.'*dNtetaZ_dx)) +...
    pi*R^2*ks*G*...
    2*((NtetaZ.' - dNv_dx.')*(NtetaZ - dNv_dx) + (NtetaY.' + dNw_dx.')*(NtetaY + dNw_dx)) +...
    pi*R^4*ks*G*...
    ((1/2)*2*...
    (dNtetaX_dx.'*dNtetaX_dx));

%%
U_piR2E_fuj = 3*du_dx^2*dNu_dx.' + du_dx^3*dNu_dx.' + dv_dx^3*dNv_dx.' + dw_dx^3*dNw_dx.' +...
     (dNu_dx.'*(dv_dx^2 + dw_dx^2) + (2*dv_dx*dNv_dx.' + 2*dw_dx*dNw_dx.')*du_dx) +...
     (du_dx*dNu_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*du_dx^2) +...
     (du_dx*dNu_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*du_dx^2) +...
     (dv_dx*dNv_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dv_dx^2);
%{
PsiPiR2E = du_dx^3 + (du_dx^4)/4 + (dv_dx^4)/4 + (dw_dx^4)/4 +...
    du_dx*dv_dx^2 + du_dx*dw_dx^2 +...
    (du_dx^2*dv_dx^2)/2 + (du_dx^2*dw_dx^2)/2 + (dv_dx^2*dw_dx^2)/2;
U_piR2E_fujRef = gradient(PsiPiR2E,uj);
erro = simplify(U_piR2E_fujRef - U_piR2E_fuj);
ad = 1;
%ok!
%}
U_piR4E_fuj =...
    ((tetaY*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2)/2 +...
     (2*dtetaX_dx*dNtetaX_dx.'*du_dx + dNu_dx.'*dtetaX_dx^2)/2 +...
     (2*dtetaY_dx*dNtetaY_dx.'*du_dx + dNu_dx.'*dtetaY_dx^2)*(3/4) +...
     (2*dtetaZ_dx*dNtetaZ_dx.'*du_dx + dNu_dx.'*dtetaZ_dx^2)*(3/4) +...
     (dtetaX_dx*dNtetaX_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaX_dx^2)/2 +...
     (dtetaY_dx*dNtetaY_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaY_dx^2)*(3/4) +...
     (dtetaZ_dx*dNtetaZ_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaZ_dx^2)*(3/4) +...
     (dtetaX_dx*dNtetaX_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaX_dx^2) +...
     (dtetaY_dx*dNtetaY_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaY_dx^2)/4 +...
     (dtetaZ_dx*dNtetaZ_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaZ_dx^2)/4 +...
     (dtetaX_dx*dNtetaX_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaX_dx^2) +...
     (dtetaY_dx*dNtetaY_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaY_dx^2)/4 +...
     (dtetaZ_dx*dNtetaZ_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaZ_dx^2)/4 -...
     (dNtetaX_dx.'*dtetaY_dx*dv_dx + dNtetaY_dx.'*dtetaX_dx*dv_dx + dNv_dx.'*dtetaX_dx*dtetaY_dx)/2 -...
     (dNtetaX_dx.'*dtetaZ_dx*dw_dx + dNtetaZ_dx.'*dtetaX_dx*dw_dx + dNw_dx.'*dtetaX_dx*dtetaZ_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx)/2 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx)/2 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*du_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*du_dx^2 + du_dx*dNu_dx.'*tetaY^2*dtetaX_dx^2)*(3/4) +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*du_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*du_dx^2 + du_dx*dNu_dx.'*tetaZ^2*dtetaX_dx^2)*(3/4) +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dv_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dv_dx^2 + dv_dx*dNv_dx.'*tetaY^2*dtetaX_dx^2)/4 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dv_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dv_dx^2 + dv_dx*dNv_dx.'*tetaZ^2*dtetaX_dx^2)/4 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dw_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dw_dx^2 + dw_dx*dNw_dx.'*tetaY^2*dtetaX_dx^2)/4 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dw_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dw_dx^2 + dw_dx*dNw_dx.'*tetaZ^2*dtetaX_dx^2)/4 -...
     (NtetaZ.'*dtetaX_dx^2*dv_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ*dv_dx + dNv_dx.'*tetaZ*dtetaX_dx^2)/2 +...
     (NtetaY.'*dtetaX_dx^2*dw_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*dw_dx + dNw_dx.'*tetaY*dtetaX_dx^2)/2 +...
     (2*tetaY*NtetaY.'*dtetaX_dx^2*du_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY^2*du_dx + dNu_dx.'*tetaY^2*dtetaX_dx^2)*(3/4) +...
     (2*tetaZ*NtetaZ.'*dtetaX_dx^2*du_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ^2*du_dx + dNu_dx.'*tetaZ^2*dtetaX_dx^2)*(3/4) -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*du_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*du_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*du_dx^2 + 2*du_dx*dNu_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)*(3/4) +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*du_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*du_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*du_dx^2 + 2*du_dx*dNu_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)*(3/4) -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*dv_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*dv_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*dv_dx^2 + 2*dv_dx*dNv_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)/4 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*dv_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dv_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dv_dx^2 + 2*dv_dx*dNv_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/4 -...
     (NtetaZ.'*dtetaX_dx^2*du_dx*dv_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ*du_dx*dv_dx + dNu_dx.'*tetaZ*dtetaX_dx^2*dv_dx + dNv_dx.'*tetaZ*dtetaX_dx^2*du_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*dw_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*dw_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*dw_dx^2 + 2*dw_dx*dNw_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)/4 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*dw_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dw_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dw_dx^2 + 2*dw_dx*dNw_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/4 +...
     (NtetaY.'*dtetaX_dx^2*du_dx*dw_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*du_dx*dw_dx + dNu_dx.'*tetaY*dtetaX_dx^2*dw_dx + dNw_dx.'*tetaY*dtetaX_dx^2*du_dx)/2 -...
     (dNtetaX_dx.'*dtetaY_dx*du_dx*dv_dx + dNtetaY_dx.'*dtetaX_dx*du_dx*dv_dx + dNu_dx.'*dtetaX_dx*dtetaY_dx*dv_dx + dNv_dx.'*dtetaX_dx*dtetaY_dx*du_dx)/2 -...
     (dNtetaX_dx.'*dtetaZ_dx*du_dx*dw_dx + dNtetaZ_dx.'*dtetaX_dx*du_dx*dw_dx + dNu_dx.'*dtetaX_dx*dtetaZ_dx*dw_dx + dNw_dx.'*dtetaX_dx*dtetaZ_dx*du_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*du_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx*du_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx*du_dx + dNu_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)*(3/2) +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*du_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx*du_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx*du_dx + dNu_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)*(3/2));
%{
PsiPiR4E = (tetaY^2*dtetaX_dx^2)/4 + (tetaZ^2*dtetaX_dx^2)/4 +...
    (dtetaX_dx^2*du_dx)/2 + (3*dtetaY_dx^2*du_dx)/4 + (3*dtetaZ_dx^2*du_dx)/4 +...
    (dtetaX_dx^2*du_dx^2)/4 + (3*dtetaY_dx^2*du_dx^2)/8 + (3*dtetaZ_dx^2*du_dx^2)/8 +...
    (dtetaX_dx^2*dv_dx^2)/2 + (dtetaY_dx^2*dv_dx^2)/8 + (dtetaZ_dx^2*dv_dx^2)/8 +...
    (dtetaX_dx^2*dw_dx^2)/2 + (dtetaY_dx^2*dw_dx^2)/8 + (dtetaZ_dx^2*dw_dx^2)/8 -...
    (dtetaX_dx*dtetaY_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*dw_dx)/2 -...
    (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
    (3*tetaY^2*dtetaX_dx^2*du_dx^2)/8 + (3*tetaZ^2*dtetaX_dx^2*du_dx^2)/8 +...
    (tetaY^2*dtetaX_dx^2*dv_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dv_dx^2)/8 +...
    (tetaY^2*dtetaX_dx^2*dw_dx^2)/8 + (tetaZ^2*dtetaX_dx^2*dw_dx^2)/8 -...
    (tetaZ*dtetaX_dx^2*dv_dx)/2 + (tetaY*dtetaX_dx^2*dw_dx)/2 +...
    (3*tetaY^2*dtetaX_dx^2*du_dx)/4 + (3*tetaZ^2*dtetaX_dx^2*du_dx)/4 -...
    (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx^2)/4 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx^2)/4 -...
    (tetaY*dtetaX_dx*dtetaZ_dx*dv_dx^2)/4 + (tetaZ*dtetaX_dx*dtetaY_dx*dv_dx^2)/4 -...
    (tetaZ*dtetaX_dx^2*du_dx*dv_dx)/2 - (tetaY*dtetaX_dx*dtetaZ_dx*dw_dx^2)/4 +...
    (tetaZ*dtetaX_dx*dtetaY_dx*dw_dx^2)/4 + (tetaY*dtetaX_dx^2*du_dx*dw_dx)/2 -...
    (dtetaX_dx*dtetaY_dx*du_dx*dv_dx)/2 - (dtetaX_dx*dtetaZ_dx*du_dx*dw_dx)/2 -...
    (3*tetaY*dtetaX_dx*dtetaZ_dx*du_dx)/2 + (3*tetaZ*dtetaX_dx*dtetaY_dx*du_dx)/2;
U_piR4E_fujRef = gradient(PsiPiR4E,uj);
erro = simplify(U_piR4E_fujRef - U_piR4E_fuj);
ad = 1;
%ok!
%}
U_piR6E_fuj = (dNtetaX_dx.'*dtetaX_dx^3)/3 + (dNtetaY_dx.'*dtetaY_dx^3)/8 + (dNtetaZ_dx.'*dtetaZ_dx^3)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaY^2)/6 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaZ^2)/6 +...
     (tetaY^3*NtetaY.'*dtetaX_dx^4 + dtetaX_dx^3*dNtetaX_dx.'*tetaY^4)/8 +...
     (tetaZ^3*NtetaZ.'*dtetaX_dx^4 + dtetaX_dx^3*dNtetaX_dx.'*tetaZ^4)/8 +...
     (dtetaX_dx*dNtetaX_dx.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*dtetaX_dx^2)/6 +...
     (dtetaX_dx*dNtetaX_dx.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*dtetaX_dx^2)/6 +...
     (dtetaY_dx*dNtetaY_dx.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*dtetaY_dx^2)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dtetaY_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaY^2*dtetaX_dx^2)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dtetaZ_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaY^2*dtetaX_dx^2)*(3/8) +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dtetaY_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaZ^2*dtetaX_dx^2)*(3/8) +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dtetaZ_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaZ^2*dtetaX_dx^2)/8 +...
     (tetaY*NtetaY.'*tetaZ^2*dtetaX_dx^4 + tetaZ*NtetaZ.'*tetaY^2*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaY^2*tetaZ^2)/8 -...
     (NtetaY.'*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx^3)/6 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx^3 + dNtetaX_dx.'*tetaY*dtetaZ_dx^3 + 3*dtetaZ_dx^2*dNtetaZ_dx.'*tetaY*dtetaX_dx)/8 +...
     (NtetaZ.'*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx^3)/6 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx^3 + dNtetaX_dx.'*tetaZ*dtetaY_dx^3 + 3*dtetaY_dx^2*dNtetaY_dx.'*tetaZ*dtetaX_dx)/8 -...
     (3*tetaY^2*NtetaY.'*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY^3*dtetaZ_dx + dNtetaZ_dx.'*tetaY^3*dtetaX_dx^3)/8 +...
     (3*tetaZ^2*NtetaZ.'*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaZ^3*dtetaY_dx + dNtetaY_dx.'*tetaZ^3*dtetaX_dx^3)/8 -...
     (NtetaY.'*dtetaX_dx*dtetaY_dx^2*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaY_dx^2*dtetaZ_dx + 2*dtetaY_dx*dNtetaY_dx.'*tetaY*dtetaX_dx*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx*dtetaY_dx^2)/8 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*dtetaZ_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dtetaZ_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dtetaZ_dx^2 + 2*dtetaZ_dx*dNtetaZ_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/8 +...
     (2*tetaY*NtetaY.'*tetaZ*dtetaX_dx^3*dtetaY_dx + NtetaZ.'*tetaY^2*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY^2*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaY^2*tetaZ*dtetaX_dx^3)/8 -...
     (NtetaY.'*tetaZ^2*dtetaX_dx^3*dtetaZ_dx + 2*tetaZ*NtetaZ.'*tetaY*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY*tetaZ^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ^2*dtetaX_dx^3)/8 -...
     (NtetaY.'*tetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + NtetaZ.'*tetaY*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*tetaZ*dtetaY_dx*dtetaZ_dx + dNtetaY_dx.'*tetaY*tetaZ*dtetaX_dx^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ*dtetaX_dx^2*dtetaY_dx)/4;
%{
PsiPiR6E = (dtetaX_dx^4)/12 + (dtetaY_dx^4)/32 + (dtetaZ_dx^4)/32 +...
     (tetaY^2*dtetaX_dx^4)/12 + (tetaZ^2*dtetaX_dx^4)/12 +...
     (tetaY^4*dtetaX_dx^4)/32 + (tetaZ^4*dtetaX_dx^4)/32 +...
     (dtetaX_dx^2*dtetaY_dx^2)/12 + (dtetaX_dx^2*dtetaZ_dx^2)/12 +...
     (dtetaY_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (3*tetaY^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (3*tetaZ^2*dtetaX_dx^2*dtetaY_dx^2)/16 +...
     (tetaZ^2*dtetaX_dx^2*dtetaZ_dx^2)/16 + (tetaY^2*tetaZ^2*dtetaX_dx^4)/16 -...
     (tetaY*dtetaX_dx^3*dtetaZ_dx)/6 - (tetaY*dtetaX_dx*dtetaZ_dx^3)/8 +...
     (tetaZ*dtetaX_dx^3*dtetaY_dx)/6 + (tetaZ*dtetaX_dx*dtetaY_dx^3)/8 -...
     (tetaY^3*dtetaX_dx^3*dtetaZ_dx)/8 + (tetaZ^3*dtetaX_dx^3*dtetaY_dx)/8 -...
     (tetaY*dtetaX_dx*dtetaY_dx^2*dtetaZ_dx)/8 + (tetaZ*dtetaX_dx*dtetaY_dx*dtetaZ_dx^2)/8 +...
     (tetaY^2*tetaZ*dtetaX_dx^3*dtetaY_dx)/8 - (tetaY*tetaZ^2*dtetaX_dx^3*dtetaZ_dx)/8 -...
     (tetaY*tetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx)/4;
U_piR6E_fujRef = gradient(PsiPiR6E,uj);
erro = simplify(U_piR6E_fujRef - U_piR6E_fuj);
ad = 1;
%ok!
%}
U_piR2ksG_fuj = (2*tetaY*NtetaY.'*du_dx + tetaY^2*dNu_dx.')*2 +...
     (2*tetaZ*NtetaZ.'*du_dx + tetaZ^2*dNu_dx.')*2 +...
     (2*tetaY*NtetaY.'*du_dx^2 + 2*du_dx*dNu_dx.'*tetaY^2) +...
     (2*tetaZ*NtetaZ.'*du_dx^2 + 2*du_dx*dNu_dx.'*tetaZ^2) -...
     (NtetaZ.'*du_dx*dv_dx + dNu_dx.'*tetaZ*dv_dx + dNv_dx.'*tetaZ*du_dx)*2 +...
     (NtetaY.'*du_dx*dw_dx + dNu_dx.'*tetaY*dw_dx + dNw_dx.'*tetaY*du_dx)*2;
%{
PsiPiR2ksG = 2*tetaY^2*du_dx + 2*tetaZ^2*du_dx +...
     tetaY^2*du_dx^2 + tetaZ^2*du_dx^2 -...
     2*tetaZ*du_dx*dv_dx + 2*tetaY*du_dx*dw_dx;
U_piR2ksG_fujRef = gradient(PsiPiR2ksG,uj);
erro = simplify(U_piR2ksG_fujRef - U_piR2ksG_fuj);
ad = 1;
%ok!
%}
U_piR4ksG_fuj = ...
     (tetaY*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2) +...
     (tetaY*NtetaY.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2) +...
     (tetaY*NtetaY.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaZ^2)/2 +...%
     (2*tetaY^3*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^4)/2 +...
     (tetaZ*NtetaZ.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaZ^2)/2 +...
     (2*tetaZ^3*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^4)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx)/2 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx)/2 +...%
     (tetaY*NtetaY.'*tetaZ^2*dtetaX_dx^2 + tetaZ*NtetaZ.'*tetaY^2*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*tetaZ^2) -...
     (3*tetaY^2*NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY^3*dtetaZ_dx + dNtetaZ_dx.'*tetaY^3*dtetaX_dx)/2 +...
     (3*tetaZ^2*NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ^3*dtetaY_dx + dNtetaY_dx.'*tetaZ^3*dtetaX_dx)/2 +...
     (2*tetaY*NtetaY.'*tetaZ*dtetaX_dx*dtetaY_dx + NtetaZ.'*tetaY^2*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaY^2*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaY^2*tetaZ*dtetaX_dx)/2 -...
     (NtetaY.'*tetaZ^2*dtetaX_dx*dtetaZ_dx + 2*tetaZ*NtetaZ.'*tetaY*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*tetaZ^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ^2*dtetaX_dx)/2;
%{
PsiPiR4ksG = (tetaY^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaY_dx^2)/4 +...
     (tetaZ^2*dtetaX_dx^2)/2 + (tetaY^2*dtetaZ_dx^2)/4 + (tetaZ^2*dtetaY_dx^2)/4 +...
     (tetaY^4*dtetaX_dx^2)/4 + (tetaZ^2*dtetaZ_dx^2)/4 + (tetaZ^4*dtetaX_dx^2)/4 -...
     (tetaY*dtetaX_dx*dtetaZ_dx)/2 + (tetaZ*dtetaX_dx*dtetaY_dx)/2 +...
     (tetaY^2*tetaZ^2*dtetaX_dx^2)/2 - (tetaY^3*dtetaX_dx*dtetaZ_dx)/2 +...
     (tetaZ^3*dtetaX_dx*dtetaY_dx)/2 + (tetaY^2*tetaZ*dtetaX_dx*dtetaY_dx)/2 -...
     (tetaY*tetaZ^2*dtetaX_dx*dtetaZ_dx)/2;
U_piR4ksG_fujRef = gradient(PsiPiR4ksG,uj);
erro = simplify(U_piR4ksG_fujRef - U_piR4ksG_fuj);
ad = 1;
%ok!
%}

%{
U_fuj_Aux = pi*R^2*E*U_piR2E_fuj +...
    pi*R^4*E*U_piR4E_fuj +...
    pi*R^6*E*U_piR6E_fuj +...
    pi*R^2*ks*G*U_piR2ksG_fuj +...
    pi*R^4*ks*G*U_piR4ksG_fuj;

dPsi_x_nlinear_duj_ref = gradient(Psi_x_nlinear,uj);
disp('ping_U_fuj_Aux')
erro_U_fuj_Aux = simplify(dPsi_x_nlinear_duj_ref - U_fuj_Aux);
disp('pong_U_fuj_Aux')
ad = 1;
%ok!!!
%}
U_fuj_Aux = pi*R^2*E*U_piR2E_fuj +...
    pi*R^4*E*U_piR4E_fuj +...
    pi*R^6*E*U_piR6E_fuj +...
    pi*R^2*ks*G*U_piR2ksG_fuj +...
    pi*R^4*ks*G*U_piR4ksG_fuj;

%%
U_piR2E_dfuj = 3*dNu_dx.'*2*du_dx*dNu_dx + dNu_dx.'*3*du_dx^2*dNu_dx + dNv_dx.'*3*dv_dx^2*dNv_dx + dNw_dx.'*3*dw_dx^2*dNw_dx +...
     (dNu_dx.'*(2*dv_dx*dNv_dx + 2*dw_dx*dNw_dx) +...
     (2*(dNv_dx.'*dNv_dx) + 2*(dNw_dx.'*dNw_dx))*du_dx + (2*dv_dx*dNv_dx.' + 2*dw_dx*dNw_dx.')*dNu_dx) +...
     (dNu_dx.'*(dNu_dx*dv_dx^2 + du_dx*2*dv_dx*dNv_dx) +...
      dNv_dx.'*(dNv_dx*du_dx^2 + dv_dx*2*du_dx*dNu_dx)) +...
     (dNu_dx.'*(dNu_dx*dw_dx^2 + du_dx*2*dw_dx*dNw_dx) +...
      dNw_dx.'*(dNw_dx*du_dx^2 + dw_dx*2*du_dx*dNu_dx)) +...
     (dNv_dx.'*(dNv_dx*dw_dx^2 + dv_dx*2*dw_dx*dNw_dx) +...
      dNw_dx.'*(dNw_dx*dv_dx^2 + dw_dx*2*dv_dx*dNv_dx));
%{
U_piR2E_dfujRef = jacobian(U_piR2E_fuj,uj);
erro = simplify(U_piR2E_dfujRef - U_piR2E_dfuj);
ad = 1;
%ok!
%}

%%
%{
piR4Efuj01 = (tetaY*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2)/2 +...
     (2*dtetaX_dx*dNtetaX_dx.'*du_dx + dNu_dx.'*dtetaX_dx^2)/2 +...
     (2*dtetaY_dx*dNtetaY_dx.'*du_dx + dNu_dx.'*dtetaY_dx^2)*(3/4) +...
     (2*dtetaZ_dx*dNtetaZ_dx.'*du_dx + dNu_dx.'*dtetaZ_dx^2)*(3/4);
piR4Efuj02 = (dtetaX_dx*dNtetaX_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaX_dx^2)/2 +...
     (dtetaY_dx*dNtetaY_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaY_dx^2)*(3/4) +...
     (dtetaZ_dx*dNtetaZ_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaZ_dx^2)*(3/4) +...
     (dtetaX_dx*dNtetaX_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaX_dx^2) +...
     (dtetaY_dx*dNtetaY_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaY_dx^2)/4;
piR4Efuj03 = (dtetaZ_dx*dNtetaZ_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaZ_dx^2)/4 +...
     (dtetaX_dx*dNtetaX_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaX_dx^2) +...
     (dtetaY_dx*dNtetaY_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaY_dx^2)/4 +...
     (dtetaZ_dx*dNtetaZ_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaZ_dx^2)/4 -...
     (dNtetaX_dx.'*dtetaY_dx*dv_dx + dNtetaY_dx.'*dtetaX_dx*dv_dx + dNv_dx.'*dtetaX_dx*dtetaY_dx)/2 -...
     (dNtetaX_dx.'*dtetaZ_dx*dw_dx + dNtetaZ_dx.'*dtetaX_dx*dw_dx + dNw_dx.'*dtetaX_dx*dtetaZ_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx)/2;
piR4Efuj04 = (NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx)/2 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*du_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*du_dx^2 + du_dx*dNu_dx.'*tetaY^2*dtetaX_dx^2)*(3/4) +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*du_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*du_dx^2 + du_dx*dNu_dx.'*tetaZ^2*dtetaX_dx^2)*(3/4);
piR4Efuj05 = (tetaY*NtetaY.'*dtetaX_dx^2*dv_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dv_dx^2 + dv_dx*dNv_dx.'*tetaY^2*dtetaX_dx^2)/4 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dv_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dv_dx^2 + dv_dx*dNv_dx.'*tetaZ^2*dtetaX_dx^2)/4 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dw_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dw_dx^2 + dw_dx*dNw_dx.'*tetaY^2*dtetaX_dx^2)/4 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dw_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dw_dx^2 + dw_dx*dNw_dx.'*tetaZ^2*dtetaX_dx^2)/4 -...
     (NtetaZ.'*dtetaX_dx^2*dv_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ*dv_dx + dNv_dx.'*tetaZ*dtetaX_dx^2)/2;
piR4Efuj06 = (NtetaY.'*dtetaX_dx^2*dw_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*dw_dx + dNw_dx.'*tetaY*dtetaX_dx^2)/2 +...
     (2*tetaY*NtetaY.'*dtetaX_dx^2*du_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY^2*du_dx + dNu_dx.'*tetaY^2*dtetaX_dx^2)*(3/4) +...
     (2*tetaZ*NtetaZ.'*dtetaX_dx^2*du_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ^2*du_dx + dNu_dx.'*tetaZ^2*dtetaX_dx^2)*(3/4) -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*du_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*du_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*du_dx^2 + 2*du_dx*dNu_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)*(3/4); 
piR4Efuj07 = (NtetaZ.'*dtetaX_dx*dtetaY_dx*du_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*du_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*du_dx^2 + 2*du_dx*dNu_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)*(3/4) -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*dv_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*dv_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*dv_dx^2 + 2*dv_dx*dNv_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)/4 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*dv_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dv_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dv_dx^2 + 2*dv_dx*dNv_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/4 -...
     (NtetaZ.'*dtetaX_dx^2*du_dx*dv_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ*du_dx*dv_dx + dNu_dx.'*tetaZ*dtetaX_dx^2*dv_dx + dNv_dx.'*tetaZ*dtetaX_dx^2*du_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*dw_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*dw_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*dw_dx^2 + 2*dw_dx*dNw_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)/4 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*dw_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dw_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dw_dx^2 + 2*dw_dx*dNw_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/4;
piR4Efuj08 = (NtetaY.'*dtetaX_dx^2*du_dx*dw_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*du_dx*dw_dx + dNu_dx.'*tetaY*dtetaX_dx^2*dw_dx + dNw_dx.'*tetaY*dtetaX_dx^2*du_dx)/2 -...
     (dNtetaX_dx.'*dtetaY_dx*du_dx*dv_dx + dNtetaY_dx.'*dtetaX_dx*du_dx*dv_dx + dNu_dx.'*dtetaX_dx*dtetaY_dx*dv_dx + dNv_dx.'*dtetaX_dx*dtetaY_dx*du_dx)/2 -...
     (dNtetaX_dx.'*dtetaZ_dx*du_dx*dw_dx + dNtetaZ_dx.'*dtetaX_dx*du_dx*dw_dx + dNu_dx.'*dtetaX_dx*dtetaZ_dx*dw_dx + dNw_dx.'*dtetaX_dx*dtetaZ_dx*du_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*du_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx*du_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx*du_dx + dNu_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)*(3/2) +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*du_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx*du_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx*du_dx + dNu_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)*(3/2);
erro = simplify(U_piR4E_fuj - (piR4Efuj01 + piR4Efuj02 + piR4Efuj03 + piR4Efuj04 + piR4Efuj05 + piR4Efuj06 + piR4Efuj07 + piR4Efuj08));
ad = 1;
%ok!
%}
%{
piR4Edfuj01 = (NtetaY.'*(NtetaY*dtetaX_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx) +...
    dNtetaX_dx.'*(dNtetaX_dx*tetaY^2 + dtetaX_dx*2*tetaY*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx) +...
    dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2 + dtetaX_dx*2*tetaZ*NtetaZ))/2 +...
    (dNtetaX_dx.'*2*(dNtetaX_dx*du_dx + dtetaX_dx*dNu_dx) +...
    dNu_dx.'*2*dtetaX_dx*dNtetaX_dx)/2 +...
    (dNtetaY_dx.'*2*(dNtetaY_dx*du_dx + dtetaY_dx*dNu_dx) +...
    dNu_dx.'*2*dtetaY_dx*dNtetaY_dx)*(3/4) +...
    (dNtetaZ_dx.'*2*(dNtetaZ_dx*du_dx + dtetaZ_dx*dNu_dx) +...
    dNu_dx.'*2*dtetaZ_dx*dNtetaZ_dx)*(3/4);
%{
piR4Efuj01 = (tetaY*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2)/2 +...
     (2*dtetaX_dx*dNtetaX_dx.'*du_dx + dNu_dx.'*dtetaX_dx^2)/2 +...
     (2*dtetaY_dx*dNtetaY_dx.'*du_dx + dNu_dx.'*dtetaY_dx^2)*(3/4) +...
     (2*dtetaZ_dx*dNtetaZ_dx.'*du_dx + dNu_dx.'*dtetaZ_dx^2)*(3/4);
piR4Edfuj01Ref = jacobian(piR4Efuj01,uj);
erro = simplify(piR4Edfuj01Ref - piR4Edfuj01);
ad = 1;
%ok!
%}
piR4Edfuj02 = (dNtetaX_dx.'*(dNtetaX_dx*du_dx^2 + dtetaX_dx*2*du_dx*dNu_dx) +...
    dNu_dx.'*(dNu_dx*dtetaX_dx^2 + du_dx*2*dtetaX_dx*dNtetaX_dx))/2 +...
    (dNtetaY_dx.'*(dNtetaY_dx*du_dx^2 + dtetaY_dx*2*du_dx*dNu_dx) +...
    dNu_dx.'*(dNu_dx*dtetaY_dx^2 + du_dx*2*dtetaY_dx*dNtetaY_dx))*(3/4) +...
    (dNtetaZ_dx.'*(dNtetaZ_dx*du_dx^2 + dtetaZ_dx*2*du_dx*dNu_dx) +...
    dNu_dx.'*(dNu_dx*dtetaZ_dx^2 + du_dx*2*dtetaZ_dx*dNtetaZ_dx))*(3/4) +...
    (dNtetaX_dx.'*(dNtetaX_dx*dv_dx^2 + dtetaX_dx*2*dv_dx*dNv_dx) +...
    dNv_dx.'*(dNv_dx*dtetaX_dx^2 + dv_dx*2*dtetaX_dx*dNtetaX_dx)) +...
    (dNtetaY_dx.'*(dNtetaY_dx*dv_dx^2 + dtetaY_dx*2*dv_dx*dNv_dx) +...
    dNv_dx.'*(dNv_dx*dtetaY_dx^2 + dv_dx*2*dtetaY_dx*dNtetaY_dx))/4;
%{
piR4Efuj02 = (dtetaX_dx*dNtetaX_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaX_dx^2)/2 +...
     (dtetaY_dx*dNtetaY_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaY_dx^2)*(3/4) +...
     (dtetaZ_dx*dNtetaZ_dx.'*du_dx^2 + du_dx*dNu_dx.'*dtetaZ_dx^2)*(3/4) +...
     (dtetaX_dx*dNtetaX_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaX_dx^2) +...
     (dtetaY_dx*dNtetaY_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaY_dx^2)/4;
piR4Edfuj02Ref = jacobian(piR4Efuj02,uj);
erro = simplify(piR4Edfuj02Ref - piR4Edfuj02);
ad = 1;
%ok!
%}
piR4Edfuj03 = (dNtetaZ_dx.'*(dNtetaZ_dx*dv_dx^2 + dtetaZ_dx*2*dv_dx*dNv_dx) +...
    dNv_dx.'*(dNv_dx*dtetaZ_dx^2 + dv_dx*2*dtetaZ_dx*dNtetaZ_dx))/4 +...
    (dNtetaX_dx.'*(dNtetaX_dx*dw_dx^2 + dtetaX_dx*2*dw_dx*dNw_dx) +...
    dNw_dx.'*(dNw_dx*dtetaX_dx^2 + dw_dx*2*dtetaX_dx*dNtetaX_dx)) +...
    (dNtetaY_dx.'*(dNtetaY_dx*dw_dx^2 + dtetaY_dx*2*dw_dx*dNw_dx) +...
    dNw_dx.'*(dNw_dx*dtetaY_dx^2 + dw_dx*2*dtetaY_dx*dNtetaY_dx))/4 +...
    (dNtetaZ_dx.'*(dNtetaZ_dx*dw_dx^2 + dtetaZ_dx*2*dw_dx*dNw_dx) +...
    dNw_dx.'*(dNw_dx*dtetaZ_dx^2 + dw_dx*2*dtetaZ_dx*dNtetaZ_dx))/4 -...
    (dNtetaX_dx.'*(dNtetaY_dx*dv_dx + dtetaY_dx*dNv_dx) +...
    dNtetaY_dx.'*(dNtetaX_dx*dv_dx + dtetaX_dx*dNv_dx) +...
    dNv_dx.'*(dNtetaX_dx*dtetaY_dx + dtetaX_dx*dNtetaY_dx))/2 -...
    (dNtetaX_dx.'*(dNtetaZ_dx*dw_dx + dtetaZ_dx*dNw_dx) +...
    dNtetaZ_dx.'*(dNtetaX_dx*dw_dx + dtetaX_dx*dNw_dx) +...
    dNw_dx.'*(dNtetaX_dx*dtetaZ_dx + dtetaX_dx*dNtetaZ_dx))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx + dtetaX_dx*dNtetaZ_dx) +...
    dNtetaX_dx.'*(NtetaY*dtetaZ_dx + tetaY*dNtetaZ_dx) +...
    dNtetaZ_dx.'*(NtetaY*dtetaX_dx + tetaY*dNtetaX_dx))/2;
%{
piR4Efuj03 = (dtetaZ_dx*dNtetaZ_dx.'*dv_dx^2 + dv_dx*dNv_dx.'*dtetaZ_dx^2)/4 +...
     (dtetaX_dx*dNtetaX_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaX_dx^2) +...
     (dtetaY_dx*dNtetaY_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaY_dx^2)/4 +...
     (dtetaZ_dx*dNtetaZ_dx.'*dw_dx^2 + dw_dx*dNw_dx.'*dtetaZ_dx^2)/4 -...
     (dNtetaX_dx.'*dtetaY_dx*dv_dx + dNtetaY_dx.'*dtetaX_dx*dv_dx + dNv_dx.'*dtetaX_dx*dtetaY_dx)/2 -...
     (dNtetaX_dx.'*dtetaZ_dx*dw_dx + dNtetaZ_dx.'*dtetaX_dx*dw_dx + dNw_dx.'*dtetaX_dx*dtetaZ_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx)/2; 
piR4Edfuj03Ref = jacobian(piR4Efuj03,uj);
erro = simplify(piR4Edfuj03Ref - piR4Edfuj03);
ad = 1;
%ok!
%}
piR4Edfuj04 = (NtetaZ.'*(dNtetaX_dx*dtetaY_dx + dtetaX_dx*dNtetaY_dx) +...
    dNtetaX_dx.'*(NtetaZ*dtetaY_dx + tetaZ*dNtetaY_dx) +...
    dNtetaY_dx.'*(NtetaZ*dtetaX_dx + tetaZ*dNtetaX_dx))/2 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*du_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*du_dx^2 + tetaY*dtetaX_dx^2*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*du_dx^2 + dtetaX_dx*2*tetaY*NtetaY*du_dx^2 + dtetaX_dx*tetaY^2*2*du_dx*dNu_dx) +...
     dNu_dx.'*(dNu_dx*tetaY^2*dtetaX_dx^2 + du_dx*2*tetaY*NtetaY*dtetaX_dx^2 + du_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))*(3/4) +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*du_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*du_dx^2 + tetaZ*dtetaX_dx^2*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*du_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*du_dx^2 + dtetaX_dx*tetaZ^2*2*du_dx*dNu_dx) +...
     dNu_dx.'*(dNu_dx*tetaZ^2*dtetaX_dx^2 + du_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + du_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))*(3/4);
%{
piR4Efuj04 = (NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx)/2 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*du_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*du_dx^2 + du_dx*dNu_dx.'*tetaY^2*dtetaX_dx^2)*(3/4) +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*du_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*du_dx^2 + du_dx*dNu_dx.'*tetaZ^2*dtetaX_dx^2)*(3/4);
piR4Edfuj04Ref = jacobian(piR4Efuj04,uj);
erro = simplify(piR4Edfuj04Ref - piR4Edfuj04);
ad = 1;
%ok!
%}
piR4Edfuj05 = (NtetaY.'*(NtetaY*dtetaX_dx^2*dv_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dv_dx^2 + tetaY*dtetaX_dx^2*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dv_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dv_dx^2 + dtetaX_dx*tetaY^2*2*dv_dx*dNv_dx) +...
     dNv_dx.'*(dNv_dx*tetaY^2*dtetaX_dx^2 + dv_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dv_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))/4 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dv_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dv_dx^2 + tetaZ*dtetaX_dx^2*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dv_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dv_dx^2 + dtetaX_dx*tetaZ^2*2*dv_dx*dNv_dx) +...
     dNv_dx.'*(dNv_dx*tetaZ^2*dtetaX_dx^2 + dv_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dv_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))/4 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*dw_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dw_dx^2 + tetaY*dtetaX_dx^2*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dw_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dw_dx^2 + dtetaX_dx*tetaY^2*2*dw_dx*dNw_dx) +...
     dNw_dx.'*(dNw_dx*tetaY^2*dtetaX_dx^2 + dw_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dw_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))/4 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dw_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dw_dx^2 + tetaZ*dtetaX_dx^2*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dw_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dw_dx^2 + dtetaX_dx*tetaZ^2*2*dw_dx*dNw_dx) +...
     dNw_dx.'*(dNw_dx*tetaZ^2*dtetaX_dx^2 + dw_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dw_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))/4 -...
    (NtetaZ.'*(2*dtetaX_dx*dNtetaX_dx*dv_dx + dtetaX_dx^2*dNv_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaZ*dv_dx + dtetaX_dx*NtetaZ*dv_dx + dtetaX_dx*tetaZ*dNv_dx) +...
     dNv_dx.'*(NtetaZ*dtetaX_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx))/2;
%{
piR4Efuj05 = (tetaY*NtetaY.'*dtetaX_dx^2*dv_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dv_dx^2 + dv_dx*dNv_dx.'*tetaY^2*dtetaX_dx^2)/4 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dv_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dv_dx^2 + dv_dx*dNv_dx.'*tetaZ^2*dtetaX_dx^2)/4 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dw_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dw_dx^2 + dw_dx*dNw_dx.'*tetaY^2*dtetaX_dx^2)/4 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dw_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dw_dx^2 + dw_dx*dNw_dx.'*tetaZ^2*dtetaX_dx^2)/4 -...
     (NtetaZ.'*dtetaX_dx^2*dv_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ*dv_dx + dNv_dx.'*tetaZ*dtetaX_dx^2)/2;
piR4Edfuj05Ref = jacobian(piR4Efuj05,uj);
erro = simplify(piR4Edfuj05Ref - piR4Edfuj05);
ad = 1;
%ok!
%}
piR4Edfuj06 = (NtetaY.'*(2*dtetaX_dx*dNtetaX_dx*dw_dx + dtetaX_dx^2*dNw_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY*dw_dx + dtetaX_dx*NtetaY*dw_dx + dtetaX_dx*tetaY*dNw_dx) +...
     dNw_dx.'*(NtetaY*dtetaX_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx))/2 +...
    (NtetaY.'*2*(NtetaY*dtetaX_dx^2*du_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaY*dtetaX_dx^2*dNu_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY^2*du_dx + dtetaX_dx*2*tetaY*NtetaY*du_dx + dtetaX_dx*tetaY^2*dNu_dx) +...
     dNu_dx.'*(2*tetaY*NtetaY*dtetaX_dx^2 + tetaY^2*2*dtetaX_dx*dNtetaX_dx))*(3/4) +...
    (NtetaZ.'*2*(NtetaZ*dtetaX_dx^2*du_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaZ*dtetaX_dx^2*dNu_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaZ^2*du_dx + dtetaX_dx*2*tetaZ*NtetaZ*du_dx + dtetaX_dx*tetaZ^2*dNu_dx) +...
     dNu_dx.'*(2*tetaZ*NtetaZ*dtetaX_dx^2 + tetaZ^2*2*dtetaX_dx*dNtetaX_dx))*(3/4) -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*du_dx^2 + dtetaX_dx*dNtetaZ_dx*du_dx^2 + dtetaX_dx*dtetaZ_dx*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*du_dx^2 + tetaY*dNtetaZ_dx*du_dx^2 + tetaY*dtetaZ_dx*2*du_dx*dNu_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*du_dx^2 + tetaY*dNtetaX_dx*du_dx^2 + tetaY*dtetaX_dx*2*du_dx*dNu_dx) +...
     dNu_dx.'*2*(dNu_dx*tetaY*dtetaX_dx*dtetaZ_dx + du_dx*NtetaY*dtetaX_dx*dtetaZ_dx + du_dx*tetaY*dNtetaX_dx*dtetaZ_dx + du_dx*tetaY*dtetaX_dx*dNtetaZ_dx))*(3/4); 
%{
piR4Efuj06 = (NtetaY.'*dtetaX_dx^2*dw_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*dw_dx + dNw_dx.'*tetaY*dtetaX_dx^2)/2 +...
     (2*tetaY*NtetaY.'*dtetaX_dx^2*du_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY^2*du_dx + dNu_dx.'*tetaY^2*dtetaX_dx^2)*(3/4) +...
     (2*tetaZ*NtetaZ.'*dtetaX_dx^2*du_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ^2*du_dx + dNu_dx.'*tetaZ^2*dtetaX_dx^2)*(3/4) -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*du_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*du_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*du_dx^2 + 2*du_dx*dNu_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)*(3/4);
piR4Edfuj06Ref = jacobian(piR4Efuj06,uj);
erro = simplify(piR4Edfuj06Ref - piR4Edfuj06);
ad = 1;
%ok!
%}
piR4Edfuj07 = (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*du_dx^2 + dtetaX_dx*dNtetaY_dx*du_dx^2 + dtetaX_dx*dtetaY_dx*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*du_dx^2 + tetaZ*dNtetaY_dx*du_dx^2 + tetaZ*dtetaY_dx*2*du_dx*dNu_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*du_dx^2 + tetaZ*dNtetaX_dx*du_dx^2 + tetaZ*dtetaX_dx*2*du_dx*dNu_dx) +...
     dNu_dx.'*2*(dNu_dx*tetaZ*dtetaX_dx*dtetaY_dx + du_dx*NtetaZ*dtetaX_dx*dtetaY_dx + du_dx*tetaZ*dNtetaX_dx*dtetaY_dx + du_dx*tetaZ*dtetaX_dx*dNtetaY_dx))*(3/4) -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*dv_dx^2 + dtetaX_dx*dNtetaZ_dx*dv_dx^2 + dtetaX_dx*dtetaZ_dx*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*dv_dx^2 + tetaY*dNtetaZ_dx*dv_dx^2 + tetaY*dtetaZ_dx*2*dv_dx*dNv_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*dv_dx^2 + tetaY*dNtetaX_dx*dv_dx^2 + tetaY*dtetaX_dx*2*dv_dx*dNv_dx) +...
     dNv_dx.'*2*(dNv_dx*tetaY*dtetaX_dx*dtetaZ_dx + dv_dx*NtetaY*dtetaX_dx*dtetaZ_dx + dv_dx*tetaY*dNtetaX_dx*dtetaZ_dx + dv_dx*tetaY*dtetaX_dx*dNtetaZ_dx))/4 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*dv_dx^2 + dtetaX_dx*dNtetaY_dx*dv_dx^2 + dtetaX_dx*dtetaY_dx*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*dv_dx^2 + tetaZ*dNtetaY_dx*dv_dx^2 + tetaZ*dtetaY_dx*2*dv_dx*dNv_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*dv_dx^2 + tetaZ*dNtetaX_dx*dv_dx^2 + tetaZ*dtetaX_dx*2*dv_dx*dNv_dx) +...
     dNv_dx.'*2*(dNv_dx*tetaZ*dtetaX_dx*dtetaY_dx + dv_dx*NtetaZ*dtetaX_dx*dtetaY_dx + dv_dx*tetaZ*dNtetaX_dx*dtetaY_dx + dv_dx*tetaZ*dtetaX_dx*dNtetaY_dx))/4 -...
    (NtetaZ.'*(2*dtetaX_dx*dNtetaX_dx*du_dx*dv_dx + dtetaX_dx^2*dNu_dx*dv_dx + dtetaX_dx^2*du_dx*dNv_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaZ*du_dx*dv_dx + dtetaX_dx*NtetaZ*du_dx*dv_dx + dtetaX_dx*tetaZ*dNu_dx*dv_dx + dtetaX_dx*tetaZ*du_dx*dNv_dx) +...
     dNu_dx.'*(NtetaZ*dtetaX_dx^2*dv_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*dv_dx + tetaZ*dtetaX_dx^2*dNv_dx) +...
     dNv_dx.'*(NtetaZ*dtetaX_dx^2*du_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaZ*dtetaX_dx^2*dNu_dx))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*dw_dx^2 + dtetaX_dx*dNtetaZ_dx*dw_dx^2 + dtetaX_dx*dtetaZ_dx*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*dw_dx^2 + tetaY*dNtetaZ_dx*dw_dx^2 + tetaY*dtetaZ_dx*2*dw_dx*dNw_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*dw_dx^2 + tetaY*dNtetaX_dx*dw_dx^2 + tetaY*dtetaX_dx*2*dw_dx*dNw_dx) +...
     dNw_dx.'*2*(dNw_dx*tetaY*dtetaX_dx*dtetaZ_dx + dw_dx*NtetaY*dtetaX_dx*dtetaZ_dx + dw_dx*tetaY*dNtetaX_dx*dtetaZ_dx + dw_dx*tetaY*dtetaX_dx*dNtetaZ_dx))/4 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*dw_dx^2 + dtetaX_dx*dNtetaY_dx*dw_dx^2 + dtetaX_dx*dtetaY_dx*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*dw_dx^2 + tetaZ*dNtetaY_dx*dw_dx^2 + tetaZ*dtetaY_dx*2*dw_dx*dNw_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*dw_dx^2 + tetaZ*dNtetaX_dx*dw_dx^2 + tetaZ*dtetaX_dx*2*dw_dx*dNw_dx) +...
     dNw_dx.'*2*(dNw_dx*tetaZ*dtetaX_dx*dtetaY_dx + dw_dx*NtetaZ*dtetaX_dx*dtetaY_dx + dw_dx*tetaZ*dNtetaX_dx*dtetaY_dx + dw_dx*tetaZ*dtetaX_dx*dNtetaY_dx))/4;
%{
piR4Efuj07 = (NtetaZ.'*dtetaX_dx*dtetaY_dx*du_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*du_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*du_dx^2 + 2*du_dx*dNu_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)*(3/4) -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*dv_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*dv_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*dv_dx^2 + 2*dv_dx*dNv_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)/4 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*dv_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dv_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dv_dx^2 + 2*dv_dx*dNv_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/4 -...
     (NtetaZ.'*dtetaX_dx^2*du_dx*dv_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaZ*du_dx*dv_dx + dNu_dx.'*tetaZ*dtetaX_dx^2*dv_dx + dNv_dx.'*tetaZ*dtetaX_dx^2*du_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*dw_dx^2 + dNtetaX_dx.'*tetaY*dtetaZ_dx*dw_dx^2 + dNtetaZ_dx.'*tetaY*dtetaX_dx*dw_dx^2 + 2*dw_dx*dNw_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)/4 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*dw_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dw_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dw_dx^2 + 2*dw_dx*dNw_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/4;
piR4Edfuj07Ref = jacobian(piR4Efuj07,uj);
erro = simplify(piR4Edfuj07Ref - piR4Edfuj07);
ad = 1;
%ok!
%}
piR4Edfuj08 = (NtetaY.'*(2*dtetaX_dx*dNtetaX_dx*du_dx*dw_dx + dtetaX_dx^2*dNu_dx*dw_dx + dtetaX_dx^2*du_dx*dNw_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY*du_dx*dw_dx + dtetaX_dx*NtetaY*du_dx*dw_dx + dtetaX_dx*tetaY*dNu_dx*dw_dx + dtetaX_dx*tetaY*du_dx*dNw_dx) +...
     dNu_dx.'*(NtetaY*dtetaX_dx^2*dw_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*dw_dx + tetaY*dtetaX_dx^2*dNw_dx) +...
     dNw_dx.'*(NtetaY*dtetaX_dx^2*du_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaY*dtetaX_dx^2*dNu_dx))/2 -...
    (dNtetaX_dx.'*(dNtetaY_dx*du_dx*dv_dx + dtetaY_dx*dNu_dx*dv_dx + dtetaY_dx*du_dx*dNv_dx) +...
     dNtetaY_dx.'*(dNtetaX_dx*du_dx*dv_dx + dtetaX_dx*dNu_dx*dv_dx + dtetaX_dx*du_dx*dNv_dx) +...
     dNu_dx.'*(dNtetaX_dx*dtetaY_dx*dv_dx + dtetaX_dx*dNtetaY_dx*dv_dx + dtetaX_dx*dtetaY_dx*dNv_dx) +...
     dNv_dx.'*(dNtetaX_dx*dtetaY_dx*du_dx + dtetaX_dx*dNtetaY_dx*du_dx + dtetaX_dx*dtetaY_dx*dNu_dx))/2 -...
    (dNtetaX_dx.'*(dNtetaZ_dx*du_dx*dw_dx + dtetaZ_dx*dNu_dx*dw_dx + dtetaZ_dx*du_dx*dNw_dx) +...
     dNtetaZ_dx.'*(dNtetaX_dx*du_dx*dw_dx + dtetaX_dx*dNu_dx*dw_dx + dtetaX_dx*du_dx*dNw_dx) +...
     dNu_dx.'*(dNtetaX_dx*dtetaZ_dx*dw_dx + dtetaX_dx*dNtetaZ_dx*dw_dx + dtetaX_dx*dtetaZ_dx*dNw_dx) +...
     dNw_dx.'*(dNtetaX_dx*dtetaZ_dx*du_dx + dtetaX_dx*dNtetaZ_dx*du_dx + dtetaX_dx*dtetaZ_dx*dNu_dx))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*du_dx + dtetaX_dx*dNtetaZ_dx*du_dx + dtetaX_dx*dtetaZ_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*du_dx + tetaY*dNtetaZ_dx*du_dx + tetaY*dtetaZ_dx*dNu_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*du_dx + tetaY*dNtetaX_dx*du_dx + tetaY*dtetaX_dx*dNu_dx) +...
     dNu_dx.'*(NtetaY*dtetaX_dx*dtetaZ_dx + tetaY*dNtetaX_dx*dtetaZ_dx + tetaY*dtetaX_dx*dNtetaZ_dx))*(3/2) +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*du_dx + dtetaX_dx*dNtetaY_dx*du_dx + dtetaX_dx*dtetaY_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*du_dx + tetaZ*dNtetaY_dx*du_dx + tetaZ*dtetaY_dx*dNu_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*du_dx + tetaZ*dNtetaX_dx*du_dx + tetaZ*dtetaX_dx*dNu_dx) +...
     dNu_dx.'*(NtetaZ*dtetaX_dx*dtetaY_dx + tetaZ*dNtetaX_dx*dtetaY_dx + tetaZ*dtetaX_dx*dNtetaY_dx))*(3/2);
%{
piR4Efuj08 = (NtetaY.'*dtetaX_dx^2*du_dx*dw_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*du_dx*dw_dx + dNu_dx.'*tetaY*dtetaX_dx^2*dw_dx + dNw_dx.'*tetaY*dtetaX_dx^2*du_dx)/2 -...
     (dNtetaX_dx.'*dtetaY_dx*du_dx*dv_dx + dNtetaY_dx.'*dtetaX_dx*du_dx*dv_dx + dNu_dx.'*dtetaX_dx*dtetaY_dx*dv_dx + dNv_dx.'*dtetaX_dx*dtetaY_dx*du_dx)/2 -...
     (dNtetaX_dx.'*dtetaZ_dx*du_dx*dw_dx + dNtetaZ_dx.'*dtetaX_dx*du_dx*dw_dx + dNu_dx.'*dtetaX_dx*dtetaZ_dx*dw_dx + dNw_dx.'*dtetaX_dx*dtetaZ_dx*du_dx)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx*du_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx*du_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx*du_dx + dNu_dx.'*tetaY*dtetaX_dx*dtetaZ_dx)*(3/2) +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx*du_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx*du_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx*du_dx + dNu_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)*(3/2);
piR4Edfuj08Ref = jacobian(piR4Efuj08,uj);
erro = simplify(piR4Edfuj08Ref - piR4Edfuj08);
ad = 1;
%ok!
%}
%}
U_piR4E_dfuj = (NtetaY.'*(NtetaY*dtetaX_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx) +...
    dNtetaX_dx.'*(dNtetaX_dx*tetaY^2 + dtetaX_dx*2*tetaY*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx) +...
    dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2 + dtetaX_dx*2*tetaZ*NtetaZ))/2 +...
    (dNtetaX_dx.'*2*(dNtetaX_dx*du_dx + dtetaX_dx*dNu_dx) +...
    dNu_dx.'*2*dtetaX_dx*dNtetaX_dx)/2 +...
    (dNtetaY_dx.'*2*(dNtetaY_dx*du_dx + dtetaY_dx*dNu_dx) +...
    dNu_dx.'*2*dtetaY_dx*dNtetaY_dx)*(3/4) +...
    (dNtetaZ_dx.'*2*(dNtetaZ_dx*du_dx + dtetaZ_dx*dNu_dx) +...
    dNu_dx.'*2*dtetaZ_dx*dNtetaZ_dx)*(3/4) +...
    (dNtetaX_dx.'*(dNtetaX_dx*du_dx^2 + dtetaX_dx*2*du_dx*dNu_dx) +...
    dNu_dx.'*(dNu_dx*dtetaX_dx^2 + du_dx*2*dtetaX_dx*dNtetaX_dx))/2 +...
    (dNtetaY_dx.'*(dNtetaY_dx*du_dx^2 + dtetaY_dx*2*du_dx*dNu_dx) +...
    dNu_dx.'*(dNu_dx*dtetaY_dx^2 + du_dx*2*dtetaY_dx*dNtetaY_dx))*(3/4) +...
    (dNtetaZ_dx.'*(dNtetaZ_dx*du_dx^2 + dtetaZ_dx*2*du_dx*dNu_dx) +...
    dNu_dx.'*(dNu_dx*dtetaZ_dx^2 + du_dx*2*dtetaZ_dx*dNtetaZ_dx))*(3/4) +...
    (dNtetaX_dx.'*(dNtetaX_dx*dv_dx^2 + dtetaX_dx*2*dv_dx*dNv_dx) +...
    dNv_dx.'*(dNv_dx*dtetaX_dx^2 + dv_dx*2*dtetaX_dx*dNtetaX_dx)) +...
    (dNtetaY_dx.'*(dNtetaY_dx*dv_dx^2 + dtetaY_dx*2*dv_dx*dNv_dx) +...
    dNv_dx.'*(dNv_dx*dtetaY_dx^2 + dv_dx*2*dtetaY_dx*dNtetaY_dx))/4 +... 
    (dNtetaZ_dx.'*(dNtetaZ_dx*dv_dx^2 + dtetaZ_dx*2*dv_dx*dNv_dx) +...
    dNv_dx.'*(dNv_dx*dtetaZ_dx^2 + dv_dx*2*dtetaZ_dx*dNtetaZ_dx))/4 +...
    (dNtetaX_dx.'*(dNtetaX_dx*dw_dx^2 + dtetaX_dx*2*dw_dx*dNw_dx) +...
    dNw_dx.'*(dNw_dx*dtetaX_dx^2 + dw_dx*2*dtetaX_dx*dNtetaX_dx)) +...
    (dNtetaY_dx.'*(dNtetaY_dx*dw_dx^2 + dtetaY_dx*2*dw_dx*dNw_dx) +...
    dNw_dx.'*(dNw_dx*dtetaY_dx^2 + dw_dx*2*dtetaY_dx*dNtetaY_dx))/4 +...
    (dNtetaZ_dx.'*(dNtetaZ_dx*dw_dx^2 + dtetaZ_dx*2*dw_dx*dNw_dx) +...
    dNw_dx.'*(dNw_dx*dtetaZ_dx^2 + dw_dx*2*dtetaZ_dx*dNtetaZ_dx))/4 -...
    (dNtetaX_dx.'*(dNtetaY_dx*dv_dx + dtetaY_dx*dNv_dx) +...
    dNtetaY_dx.'*(dNtetaX_dx*dv_dx + dtetaX_dx*dNv_dx) +...
    dNv_dx.'*(dNtetaX_dx*dtetaY_dx + dtetaX_dx*dNtetaY_dx))/2 -...
    (dNtetaX_dx.'*(dNtetaZ_dx*dw_dx + dtetaZ_dx*dNw_dx) +...
    dNtetaZ_dx.'*(dNtetaX_dx*dw_dx + dtetaX_dx*dNw_dx) +...
    dNw_dx.'*(dNtetaX_dx*dtetaZ_dx + dtetaX_dx*dNtetaZ_dx))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx + dtetaX_dx*dNtetaZ_dx) +...
    dNtetaX_dx.'*(NtetaY*dtetaZ_dx + tetaY*dNtetaZ_dx) +...
    dNtetaZ_dx.'*(NtetaY*dtetaX_dx + tetaY*dNtetaX_dx))/2 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx + dtetaX_dx*dNtetaY_dx) +...
    dNtetaX_dx.'*(NtetaZ*dtetaY_dx + tetaZ*dNtetaY_dx) +...
    dNtetaY_dx.'*(NtetaZ*dtetaX_dx + tetaZ*dNtetaX_dx))/2 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*du_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*du_dx^2 + tetaY*dtetaX_dx^2*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*du_dx^2 + dtetaX_dx*2*tetaY*NtetaY*du_dx^2 + dtetaX_dx*tetaY^2*2*du_dx*dNu_dx) +...
     dNu_dx.'*(dNu_dx*tetaY^2*dtetaX_dx^2 + du_dx*2*tetaY*NtetaY*dtetaX_dx^2 + du_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))*(3/4) +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*du_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*du_dx^2 + tetaZ*dtetaX_dx^2*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*du_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*du_dx^2 + dtetaX_dx*tetaZ^2*2*du_dx*dNu_dx) +...
     dNu_dx.'*(dNu_dx*tetaZ^2*dtetaX_dx^2 + du_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + du_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))*(3/4) +... 
     (NtetaY.'*(NtetaY*dtetaX_dx^2*dv_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dv_dx^2 + tetaY*dtetaX_dx^2*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dv_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dv_dx^2 + dtetaX_dx*tetaY^2*2*dv_dx*dNv_dx) +...
     dNv_dx.'*(dNv_dx*tetaY^2*dtetaX_dx^2 + dv_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dv_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))/4 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dv_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dv_dx^2 + tetaZ*dtetaX_dx^2*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dv_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dv_dx^2 + dtetaX_dx*tetaZ^2*2*dv_dx*dNv_dx) +...
     dNv_dx.'*(dNv_dx*tetaZ^2*dtetaX_dx^2 + dv_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dv_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))/4 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*dw_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dw_dx^2 + tetaY*dtetaX_dx^2*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dw_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dw_dx^2 + dtetaX_dx*tetaY^2*2*dw_dx*dNw_dx) +...
     dNw_dx.'*(dNw_dx*tetaY^2*dtetaX_dx^2 + dw_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dw_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))/4 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dw_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dw_dx^2 + tetaZ*dtetaX_dx^2*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dw_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dw_dx^2 + dtetaX_dx*tetaZ^2*2*dw_dx*dNw_dx) +...
     dNw_dx.'*(dNw_dx*tetaZ^2*dtetaX_dx^2 + dw_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dw_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))/4 -...
    (NtetaZ.'*(2*dtetaX_dx*dNtetaX_dx*dv_dx + dtetaX_dx^2*dNv_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaZ*dv_dx + dtetaX_dx*NtetaZ*dv_dx + dtetaX_dx*tetaZ*dNv_dx) +...
     dNv_dx.'*(NtetaZ*dtetaX_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx))/2 +...
     (NtetaY.'*(2*dtetaX_dx*dNtetaX_dx*dw_dx + dtetaX_dx^2*dNw_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY*dw_dx + dtetaX_dx*NtetaY*dw_dx + dtetaX_dx*tetaY*dNw_dx) +...
     dNw_dx.'*(NtetaY*dtetaX_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx))/2 +...
    (NtetaY.'*2*(NtetaY*dtetaX_dx^2*du_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaY*dtetaX_dx^2*dNu_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY^2*du_dx + dtetaX_dx*2*tetaY*NtetaY*du_dx + dtetaX_dx*tetaY^2*dNu_dx) +...
     dNu_dx.'*(2*tetaY*NtetaY*dtetaX_dx^2 + tetaY^2*2*dtetaX_dx*dNtetaX_dx))*(3/4) +...
    (NtetaZ.'*2*(NtetaZ*dtetaX_dx^2*du_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaZ*dtetaX_dx^2*dNu_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaZ^2*du_dx + dtetaX_dx*2*tetaZ*NtetaZ*du_dx + dtetaX_dx*tetaZ^2*dNu_dx) +...
     dNu_dx.'*(2*tetaZ*NtetaZ*dtetaX_dx^2 + tetaZ^2*2*dtetaX_dx*dNtetaX_dx))*(3/4) -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*du_dx^2 + dtetaX_dx*dNtetaZ_dx*du_dx^2 + dtetaX_dx*dtetaZ_dx*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*du_dx^2 + tetaY*dNtetaZ_dx*du_dx^2 + tetaY*dtetaZ_dx*2*du_dx*dNu_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*du_dx^2 + tetaY*dNtetaX_dx*du_dx^2 + tetaY*dtetaX_dx*2*du_dx*dNu_dx) +...
     dNu_dx.'*2*(dNu_dx*tetaY*dtetaX_dx*dtetaZ_dx + du_dx*NtetaY*dtetaX_dx*dtetaZ_dx + du_dx*tetaY*dNtetaX_dx*dtetaZ_dx + du_dx*tetaY*dtetaX_dx*dNtetaZ_dx))*(3/4) +...
     (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*du_dx^2 + dtetaX_dx*dNtetaY_dx*du_dx^2 + dtetaX_dx*dtetaY_dx*2*du_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*du_dx^2 + tetaZ*dNtetaY_dx*du_dx^2 + tetaZ*dtetaY_dx*2*du_dx*dNu_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*du_dx^2 + tetaZ*dNtetaX_dx*du_dx^2 + tetaZ*dtetaX_dx*2*du_dx*dNu_dx) +...
     dNu_dx.'*2*(dNu_dx*tetaZ*dtetaX_dx*dtetaY_dx + du_dx*NtetaZ*dtetaX_dx*dtetaY_dx + du_dx*tetaZ*dNtetaX_dx*dtetaY_dx + du_dx*tetaZ*dtetaX_dx*dNtetaY_dx))*(3/4) -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*dv_dx^2 + dtetaX_dx*dNtetaZ_dx*dv_dx^2 + dtetaX_dx*dtetaZ_dx*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*dv_dx^2 + tetaY*dNtetaZ_dx*dv_dx^2 + tetaY*dtetaZ_dx*2*dv_dx*dNv_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*dv_dx^2 + tetaY*dNtetaX_dx*dv_dx^2 + tetaY*dtetaX_dx*2*dv_dx*dNv_dx) +...
     dNv_dx.'*2*(dNv_dx*tetaY*dtetaX_dx*dtetaZ_dx + dv_dx*NtetaY*dtetaX_dx*dtetaZ_dx + dv_dx*tetaY*dNtetaX_dx*dtetaZ_dx + dv_dx*tetaY*dtetaX_dx*dNtetaZ_dx))/4 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*dv_dx^2 + dtetaX_dx*dNtetaY_dx*dv_dx^2 + dtetaX_dx*dtetaY_dx*2*dv_dx*dNv_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*dv_dx^2 + tetaZ*dNtetaY_dx*dv_dx^2 + tetaZ*dtetaY_dx*2*dv_dx*dNv_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*dv_dx^2 + tetaZ*dNtetaX_dx*dv_dx^2 + tetaZ*dtetaX_dx*2*dv_dx*dNv_dx) +...
     dNv_dx.'*2*(dNv_dx*tetaZ*dtetaX_dx*dtetaY_dx + dv_dx*NtetaZ*dtetaX_dx*dtetaY_dx + dv_dx*tetaZ*dNtetaX_dx*dtetaY_dx + dv_dx*tetaZ*dtetaX_dx*dNtetaY_dx))/4 -...
    (NtetaZ.'*(2*dtetaX_dx*dNtetaX_dx*du_dx*dv_dx + dtetaX_dx^2*dNu_dx*dv_dx + dtetaX_dx^2*du_dx*dNv_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaZ*du_dx*dv_dx + dtetaX_dx*NtetaZ*du_dx*dv_dx + dtetaX_dx*tetaZ*dNu_dx*dv_dx + dtetaX_dx*tetaZ*du_dx*dNv_dx) +...
     dNu_dx.'*(NtetaZ*dtetaX_dx^2*dv_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*dv_dx + tetaZ*dtetaX_dx^2*dNv_dx) +...
     dNv_dx.'*(NtetaZ*dtetaX_dx^2*du_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaZ*dtetaX_dx^2*dNu_dx))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*dw_dx^2 + dtetaX_dx*dNtetaZ_dx*dw_dx^2 + dtetaX_dx*dtetaZ_dx*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*dw_dx^2 + tetaY*dNtetaZ_dx*dw_dx^2 + tetaY*dtetaZ_dx*2*dw_dx*dNw_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*dw_dx^2 + tetaY*dNtetaX_dx*dw_dx^2 + tetaY*dtetaX_dx*2*dw_dx*dNw_dx) +...
     dNw_dx.'*2*(dNw_dx*tetaY*dtetaX_dx*dtetaZ_dx + dw_dx*NtetaY*dtetaX_dx*dtetaZ_dx + dw_dx*tetaY*dNtetaX_dx*dtetaZ_dx + dw_dx*tetaY*dtetaX_dx*dNtetaZ_dx))/4 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*dw_dx^2 + dtetaX_dx*dNtetaY_dx*dw_dx^2 + dtetaX_dx*dtetaY_dx*2*dw_dx*dNw_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*dw_dx^2 + tetaZ*dNtetaY_dx*dw_dx^2 + tetaZ*dtetaY_dx*2*dw_dx*dNw_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*dw_dx^2 + tetaZ*dNtetaX_dx*dw_dx^2 + tetaZ*dtetaX_dx*2*dw_dx*dNw_dx) +...
     dNw_dx.'*2*(dNw_dx*tetaZ*dtetaX_dx*dtetaY_dx + dw_dx*NtetaZ*dtetaX_dx*dtetaY_dx + dw_dx*tetaZ*dNtetaX_dx*dtetaY_dx + dw_dx*tetaZ*dtetaX_dx*dNtetaY_dx))/4 +...
     (NtetaY.'*(2*dtetaX_dx*dNtetaX_dx*du_dx*dw_dx + dtetaX_dx^2*dNu_dx*dw_dx + dtetaX_dx^2*du_dx*dNw_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY*du_dx*dw_dx + dtetaX_dx*NtetaY*du_dx*dw_dx + dtetaX_dx*tetaY*dNu_dx*dw_dx + dtetaX_dx*tetaY*du_dx*dNw_dx) +...
     dNu_dx.'*(NtetaY*dtetaX_dx^2*dw_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*dw_dx + tetaY*dtetaX_dx^2*dNw_dx) +...
     dNw_dx.'*(NtetaY*dtetaX_dx^2*du_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*du_dx + tetaY*dtetaX_dx^2*dNu_dx))/2 -...
    (dNtetaX_dx.'*(dNtetaY_dx*du_dx*dv_dx + dtetaY_dx*dNu_dx*dv_dx + dtetaY_dx*du_dx*dNv_dx) +...
     dNtetaY_dx.'*(dNtetaX_dx*du_dx*dv_dx + dtetaX_dx*dNu_dx*dv_dx + dtetaX_dx*du_dx*dNv_dx) +...
     dNu_dx.'*(dNtetaX_dx*dtetaY_dx*dv_dx + dtetaX_dx*dNtetaY_dx*dv_dx + dtetaX_dx*dtetaY_dx*dNv_dx) +...
     dNv_dx.'*(dNtetaX_dx*dtetaY_dx*du_dx + dtetaX_dx*dNtetaY_dx*du_dx + dtetaX_dx*dtetaY_dx*dNu_dx))/2 -...
    (dNtetaX_dx.'*(dNtetaZ_dx*du_dx*dw_dx + dtetaZ_dx*dNu_dx*dw_dx + dtetaZ_dx*du_dx*dNw_dx) +...
     dNtetaZ_dx.'*(dNtetaX_dx*du_dx*dw_dx + dtetaX_dx*dNu_dx*dw_dx + dtetaX_dx*du_dx*dNw_dx) +...
     dNu_dx.'*(dNtetaX_dx*dtetaZ_dx*dw_dx + dtetaX_dx*dNtetaZ_dx*dw_dx + dtetaX_dx*dtetaZ_dx*dNw_dx) +...
     dNw_dx.'*(dNtetaX_dx*dtetaZ_dx*du_dx + dtetaX_dx*dNtetaZ_dx*du_dx + dtetaX_dx*dtetaZ_dx*dNu_dx))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx*du_dx + dtetaX_dx*dNtetaZ_dx*du_dx + dtetaX_dx*dtetaZ_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx*du_dx + tetaY*dNtetaZ_dx*du_dx + tetaY*dtetaZ_dx*dNu_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*du_dx + tetaY*dNtetaX_dx*du_dx + tetaY*dtetaX_dx*dNu_dx) +...
     dNu_dx.'*(NtetaY*dtetaX_dx*dtetaZ_dx + tetaY*dNtetaX_dx*dtetaZ_dx + tetaY*dtetaX_dx*dNtetaZ_dx))*(3/2) +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*du_dx + dtetaX_dx*dNtetaY_dx*du_dx + dtetaX_dx*dtetaY_dx*dNu_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*du_dx + tetaZ*dNtetaY_dx*du_dx + tetaZ*dtetaY_dx*dNu_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*du_dx + tetaZ*dNtetaX_dx*du_dx + tetaZ*dtetaX_dx*dNu_dx) +...
     dNu_dx.'*(NtetaZ*dtetaX_dx*dtetaY_dx + tetaZ*dNtetaX_dx*dtetaY_dx + tetaZ*dtetaX_dx*dNtetaY_dx))*(3/2);
%{
U_piR4E_dfujRef = jacobian(U_piR4E_fuj,uj);
erro = simplify(U_piR4E_dfujRef - U_piR4E_dfuj);
ad = 1;
%ok!
%}

%%
%{
piR6Efuj01 = (dNtetaX_dx.'*dtetaX_dx^3)/3 + (dNtetaY_dx.'*dtetaY_dx^3)/8 + (dNtetaZ_dx.'*dtetaZ_dx^3)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaY^2)/6 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaZ^2)/6 +...
     (tetaY^3*NtetaY.'*dtetaX_dx^4 + dtetaX_dx^3*dNtetaX_dx.'*tetaY^4)/8 +...
     (tetaZ^3*NtetaZ.'*dtetaX_dx^4 + dtetaX_dx^3*dNtetaX_dx.'*tetaZ^4)/8;
piR6Efuj02 = (dtetaX_dx*dNtetaX_dx.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*dtetaX_dx^2)/6 +...
     (dtetaX_dx*dNtetaX_dx.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*dtetaX_dx^2)/6 +...
     (dtetaY_dx*dNtetaY_dx.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*dtetaY_dx^2)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dtetaY_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaY^2*dtetaX_dx^2)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dtetaZ_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaY^2*dtetaX_dx^2)*(3/8);
piR6Efuj03 = (tetaZ*NtetaZ.'*dtetaX_dx^2*dtetaY_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaZ^2*dtetaX_dx^2)*(3/8) +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dtetaZ_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaZ^2*dtetaX_dx^2)/8 +...
     (tetaY*NtetaY.'*tetaZ^2*dtetaX_dx^4 + tetaZ*NtetaZ.'*tetaY^2*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaY^2*tetaZ^2)/8 -...
     (NtetaY.'*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx^3)/6 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx^3 + dNtetaX_dx.'*tetaY*dtetaZ_dx^3 + 3*dtetaZ_dx^2*dNtetaZ_dx.'*tetaY*dtetaX_dx)/8;
piR6Efuj04 = (NtetaZ.'*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx^3)/6 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx^3 + dNtetaX_dx.'*tetaZ*dtetaY_dx^3 + 3*dtetaY_dx^2*dNtetaY_dx.'*tetaZ*dtetaX_dx)/8 -...
     (3*tetaY^2*NtetaY.'*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY^3*dtetaZ_dx + dNtetaZ_dx.'*tetaY^3*dtetaX_dx^3)/8 +...
     (3*tetaZ^2*NtetaZ.'*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaZ^3*dtetaY_dx + dNtetaY_dx.'*tetaZ^3*dtetaX_dx^3)/8 -...
     (NtetaY.'*dtetaX_dx*dtetaY_dx^2*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaY_dx^2*dtetaZ_dx + 2*dtetaY_dx*dNtetaY_dx.'*tetaY*dtetaX_dx*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx*dtetaY_dx^2)/8;
piR6Efuj05 = (NtetaZ.'*dtetaX_dx*dtetaY_dx*dtetaZ_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dtetaZ_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dtetaZ_dx^2 + 2*dtetaZ_dx*dNtetaZ_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/8 +...
     (2*tetaY*NtetaY.'*tetaZ*dtetaX_dx^3*dtetaY_dx + NtetaZ.'*tetaY^2*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY^2*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaY^2*tetaZ*dtetaX_dx^3)/8 -...
     (NtetaY.'*tetaZ^2*dtetaX_dx^3*dtetaZ_dx + 2*tetaZ*NtetaZ.'*tetaY*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY*tetaZ^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ^2*dtetaX_dx^3)/8 -...
     (NtetaY.'*tetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + NtetaZ.'*tetaY*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*tetaZ*dtetaY_dx*dtetaZ_dx + dNtetaY_dx.'*tetaY*tetaZ*dtetaX_dx^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ*dtetaX_dx^2*dtetaY_dx)/4;

erro = simplify(U_piR6E_fuj - (piR6Efuj01 + piR6Efuj02 + piR6Efuj03 + piR6Efuj04 + piR6Efuj05));
ad = 1;
%ok!
%}
%{
piR6Edfuj01 = (dNtetaX_dx.'*3*dtetaX_dx^2*dNtetaX_dx)/3 +...
    (dNtetaY_dx.'*3*dtetaY_dx^2*dNtetaY_dx)/8 +...
    (dNtetaZ_dx.'*3*dtetaZ_dx^2*dNtetaZ_dx)/8 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^4 + tetaY*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*2*(3*dtetaX_dx^2*dNtetaX_dx*tetaY^2 + dtetaX_dx^3*2*tetaY*NtetaY))/6 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^4 + tetaZ*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*2*(3*dtetaX_dx^2*dNtetaX_dx*tetaZ^2 + dtetaX_dx^3*2*tetaZ*NtetaZ))/6 +...
    (NtetaY.'*(3*tetaY^2*NtetaY*dtetaX_dx^4 + tetaY^3*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*(3*dtetaX_dx^2*dNtetaX_dx*tetaY^4 + dtetaX_dx^3*4*tetaY^3*NtetaY))/8 +...
    (NtetaZ.'*(3*tetaZ^2*NtetaZ*dtetaX_dx^4 + tetaZ^3*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*(3*dtetaX_dx^2*dNtetaX_dx*tetaZ^4 + dtetaX_dx^3*4*tetaZ^3*NtetaZ))/8;
%{
piR6Efuj01 = (dNtetaX_dx.'*dtetaX_dx^3)/3 + (dNtetaY_dx.'*dtetaY_dx^3)/8 + (dNtetaZ_dx.'*dtetaZ_dx^3)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaY^2)/6 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaZ^2)/6 +...
     (tetaY^3*NtetaY.'*dtetaX_dx^4 + dtetaX_dx^3*dNtetaX_dx.'*tetaY^4)/8 +...
     (tetaZ^3*NtetaZ.'*dtetaX_dx^4 + dtetaX_dx^3*dNtetaX_dx.'*tetaZ^4)/8;
piR6Edfuj01Ref = jacobian(piR6Efuj01,uj);
erro = simplify(piR6Edfuj01Ref - piR6Edfuj01);
ad = 1;
%ok!
%}
piR6Edfuj02 = (dNtetaX_dx.'*(dNtetaX_dx*dtetaY_dx^2 + dtetaX_dx*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*dtetaX_dx^2 + dtetaY_dx*2*dtetaX_dx*dNtetaX_dx))/6 +...
    (dNtetaX_dx.'*(dNtetaX_dx*dtetaZ_dx^2 + dtetaX_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*dtetaX_dx^2 + dtetaZ_dx*2*dtetaX_dx*dNtetaX_dx))/6 +...
    (dNtetaY_dx.'*(dNtetaY_dx*dtetaZ_dx^2 + dtetaY_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*dtetaY_dx^2 + dtetaZ_dx*2*dtetaY_dx*dNtetaY_dx))/8 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*dtetaY_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx^2 + tetaY*dtetaX_dx^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dtetaY_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dtetaY_dx^2 + dtetaX_dx*tetaY^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaY^2*dtetaX_dx^2 + dtetaY_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dtetaY_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))/8 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*dtetaZ_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dtetaZ_dx^2 + tetaY*dtetaX_dx^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dtetaZ_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dtetaZ_dx^2 + dtetaX_dx*tetaY^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaY^2*dtetaX_dx^2 + dtetaZ_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dtetaZ_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))*(3/8);
%{
piR6Efuj02 = (dtetaX_dx*dNtetaX_dx.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*dtetaX_dx^2)/6 +...
     (dtetaX_dx*dNtetaX_dx.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*dtetaX_dx^2)/6 +...
     (dtetaY_dx*dNtetaY_dx.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*dtetaY_dx^2)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dtetaY_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaY^2*dtetaX_dx^2)/8 +...
     (tetaY*NtetaY.'*dtetaX_dx^2*dtetaZ_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaY^2*dtetaX_dx^2)*(3/8);
piR6Edfuj02Ref = jacobian(piR6Efuj02,uj);
erro = simplify(piR6Edfuj02Ref - piR6Edfuj02);
ad = 1;
%ok!
%}
piR6Edfuj03 = (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dtetaY_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx^2 + tetaZ*dtetaX_dx^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dtetaY_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dtetaY_dx^2 + dtetaX_dx*tetaZ^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaZ^2*dtetaX_dx^2 + dtetaY_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dtetaY_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))*(3/8) +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dtetaZ_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaZ_dx^2 + tetaZ*dtetaX_dx^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dtetaZ_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dtetaZ_dx^2 + dtetaX_dx*tetaZ^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaZ^2*dtetaX_dx^2 + dtetaZ_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dtetaZ_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))/8 +...
    (NtetaY.'*(NtetaY*tetaZ^2*dtetaX_dx^4 + tetaY*2*tetaZ*NtetaZ*dtetaX_dx^4 + tetaY*tetaZ^2*4*dtetaX_dx^3*dNtetaX_dx) +...
     NtetaZ.'*(NtetaZ*tetaY^2*dtetaX_dx^4 + tetaZ*2*tetaY*NtetaY*dtetaX_dx^4 + tetaZ*tetaY^2*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*2*(3*dtetaX_dx^2*dNtetaX_dx*tetaY^2*tetaZ^2 + dtetaX_dx^3*2*tetaY*NtetaY*tetaZ^2 + dtetaX_dx^3*tetaY^2*2*tetaZ*NtetaZ))/8 -...
    (NtetaY.'*(3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + dtetaX_dx^3*dNtetaZ_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY*dtetaZ_dx + dtetaX_dx^2*NtetaY*dtetaZ_dx + dtetaX_dx^2*tetaY*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx^3 + tetaY*3*dtetaX_dx^2*dNtetaX_dx))/6 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx^3 + dtetaX_dx*3*dtetaZ_dx^2*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx^3 + tetaY*3*dtetaZ_dx^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*3*(2*dtetaZ_dx*dNtetaZ_dx*tetaY*dtetaX_dx + dtetaZ_dx^2*NtetaY*dtetaX_dx + dtetaZ_dx^2*tetaY*dNtetaX_dx))/8;
%{
piR6Efuj03 = (tetaZ*NtetaZ.'*dtetaX_dx^2*dtetaY_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaZ^2*dtetaX_dx^2)*(3/8) +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2*dtetaZ_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaZ^2*dtetaX_dx^2)/8 +...
     (tetaY*NtetaY.'*tetaZ^2*dtetaX_dx^4 + tetaZ*NtetaZ.'*tetaY^2*dtetaX_dx^4 + 2*dtetaX_dx^3*dNtetaX_dx.'*tetaY^2*tetaZ^2)/8 -...
     (NtetaY.'*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx^3)/6 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx^3 + dNtetaX_dx.'*tetaY*dtetaZ_dx^3 + 3*dtetaZ_dx^2*dNtetaZ_dx.'*tetaY*dtetaX_dx)/8;
piR6Edfuj03Ref = jacobian(piR6Efuj03,uj);
erro = simplify(piR6Edfuj03Ref - piR6Edfuj03);
ad = 1;
%ok!
%}
piR6Edfuj04 = (NtetaZ.'*(3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + dtetaX_dx^3*dNtetaY_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaZ*dtetaY_dx + dtetaX_dx^2*NtetaZ*dtetaY_dx + dtetaX_dx^2*tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx^3 + tetaZ*3*dtetaX_dx^2*dNtetaX_dx))/6 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx^3 + dtetaX_dx*3*dtetaY_dx^2*dNtetaY_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx^3 + tetaZ*3*dtetaY_dx^2*dNtetaY_dx) +...
     dNtetaY_dx.'*3*(2*dtetaY_dx*dNtetaY_dx*tetaZ*dtetaX_dx + dtetaY_dx^2*NtetaZ*dtetaX_dx + dtetaY_dx^2*tetaZ*dNtetaX_dx))/8 -...
    (NtetaY.'*3*(2*tetaY*NtetaY*dtetaX_dx^3*dtetaZ_dx + tetaY^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + tetaY^2*dtetaX_dx^3*dNtetaZ_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY^3*dtetaZ_dx + dtetaX_dx^2*3*tetaY^2*NtetaY*dtetaZ_dx + dtetaX_dx^2*tetaY^3*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(3*tetaY^2*NtetaY*dtetaX_dx^3 + tetaY^3*3*dtetaX_dx^2*dNtetaX_dx))/8 +...
    (NtetaZ.'*3*(2*tetaZ*NtetaZ*dtetaX_dx^3*dtetaY_dx + tetaZ^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + tetaZ^2*dtetaX_dx^3*dNtetaY_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaZ^3*dtetaY_dx + dtetaX_dx^2*3*tetaZ^2*NtetaZ*dtetaY_dx + dtetaX_dx^2*tetaZ^3*dNtetaY_dx) +...
     dNtetaY_dx.'*(3*tetaZ^2*NtetaZ*dtetaX_dx^3 + tetaZ^3*3*dtetaX_dx^2*dNtetaX_dx))/8 -...
    (NtetaY.'*(dNtetaX_dx*dtetaY_dx^2*dtetaZ_dx + dtetaX_dx*2*dtetaY_dx*dNtetaY_dx*dtetaZ_dx + dtetaX_dx*dtetaY_dx^2*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaY_dx^2*dtetaZ_dx + tetaY*2*dtetaY_dx*dNtetaY_dx*dtetaZ_dx + tetaY*dtetaY_dx^2*dNtetaZ_dx) +...
     dNtetaY_dx.'*2*(dNtetaY_dx*tetaY*dtetaX_dx*dtetaZ_dx + dtetaY_dx*NtetaY*dtetaX_dx*dtetaZ_dx + dtetaY_dx*tetaY*dNtetaX_dx*dtetaZ_dx + dtetaY_dx*tetaY*dtetaX_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*dtetaY_dx^2 + tetaY*dNtetaX_dx*dtetaY_dx^2 + tetaY*dtetaX_dx*2*dtetaY_dx*dNtetaY_dx))/8;
%{
piR6Efuj04 = (NtetaZ.'*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx^3)/6 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx^3 + dNtetaX_dx.'*tetaZ*dtetaY_dx^3 + 3*dtetaY_dx^2*dNtetaY_dx.'*tetaZ*dtetaX_dx)/8 -...
     (3*tetaY^2*NtetaY.'*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY^3*dtetaZ_dx + dNtetaZ_dx.'*tetaY^3*dtetaX_dx^3)/8 +...
     (3*tetaZ^2*NtetaZ.'*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaZ^3*dtetaY_dx + dNtetaY_dx.'*tetaZ^3*dtetaX_dx^3)/8 -...
     (NtetaY.'*dtetaX_dx*dtetaY_dx^2*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaY_dx^2*dtetaZ_dx + 2*dtetaY_dx*dNtetaY_dx.'*tetaY*dtetaX_dx*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx*dtetaY_dx^2)/8;
piR6Edfuj04Ref = jacobian(piR6Efuj04,uj);
erro = simplify(piR6Edfuj04Ref - piR6Edfuj04);
ad = 1;
%ok!
%}
piR6Edfuj05 = (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*dtetaZ_dx^2 + dtetaX_dx*dNtetaY_dx*dtetaZ_dx^2 + dtetaX_dx*dtetaY_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*dtetaZ_dx^2 + tetaZ*dNtetaY_dx*dtetaZ_dx^2 + tetaZ*dtetaY_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*dtetaZ_dx^2 + tetaZ*dNtetaX_dx*dtetaZ_dx^2 + tetaZ*dtetaX_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*2*(dNtetaZ_dx*tetaZ*dtetaX_dx*dtetaY_dx + dtetaZ_dx*NtetaZ*dtetaX_dx*dtetaY_dx + dtetaZ_dx*tetaZ*dNtetaX_dx*dtetaY_dx + dtetaZ_dx*tetaZ*dtetaX_dx*dNtetaY_dx))/8 +...
    (NtetaY.'*2*(NtetaY*tetaZ*dtetaX_dx^3*dtetaY_dx + tetaY*NtetaZ*dtetaX_dx^3*dtetaY_dx + tetaY*tetaZ*3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + tetaY*tetaZ*dtetaX_dx^3*dNtetaY_dx) +...
     NtetaZ.'*(2*tetaY*NtetaY*dtetaX_dx^3*dtetaY_dx + tetaY^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + tetaY^2*dtetaX_dx^3*dNtetaY_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY^2*tetaZ*dtetaY_dx + dtetaX_dx^2*2*tetaY*NtetaY*tetaZ*dtetaY_dx + dtetaX_dx^2*tetaY^2*NtetaZ*dtetaY_dx + dtetaX_dx^2*tetaY^2*tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(2*tetaY*NtetaY*tetaZ*dtetaX_dx^3 + tetaY^2*NtetaZ*dtetaX_dx^3 + tetaY^2*tetaZ*3*dtetaX_dx^2*dNtetaX_dx))/8 -...
    (NtetaY.'*(2*tetaZ*NtetaZ*dtetaX_dx^3*dtetaZ_dx + tetaZ^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + tetaZ^2*dtetaX_dx^3*dNtetaZ_dx) +...
     NtetaZ.'*2*(NtetaZ*tetaY*dtetaX_dx^3*dtetaZ_dx + tetaZ*NtetaY*dtetaX_dx^3*dtetaZ_dx + tetaZ*tetaY*3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + tetaZ*tetaY*dtetaX_dx^3*dNtetaZ_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY*tetaZ^2*dtetaZ_dx + dtetaX_dx^2*NtetaY*tetaZ^2*dtetaZ_dx + dtetaX_dx^2*tetaY*2*tetaZ*NtetaZ*dtetaZ_dx + dtetaX_dx^2*tetaY*tetaZ^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*tetaZ^2*dtetaX_dx^3 + tetaY*2*tetaZ*NtetaZ*dtetaX_dx^3 + tetaY*tetaZ^2*3*dtetaX_dx^2*dNtetaX_dx))/8 -...
    (NtetaY.'*(NtetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx*dtetaZ_dx + tetaZ*dtetaX_dx^2*dNtetaY_dx*dtetaZ_dx + tetaZ*dtetaX_dx^2*dtetaY_dx*dNtetaZ_dx) +...
     NtetaZ.'*(NtetaY*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx*dtetaZ_dx + tetaY*dtetaX_dx^2*dNtetaY_dx*dtetaZ_dx + tetaY*dtetaX_dx^2*dtetaY_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY*tetaZ*dtetaY_dx*dtetaZ_dx + dtetaX_dx*NtetaY*tetaZ*dtetaY_dx*dtetaZ_dx + dtetaX_dx*tetaY*NtetaZ*dtetaY_dx*dtetaZ_dx + dtetaX_dx*tetaY*tetaZ*dNtetaY_dx*dtetaZ_dx + dtetaX_dx*tetaY*tetaZ*dtetaY_dx*dNtetaZ_dx) +...
     dNtetaY_dx.'*(NtetaY*tetaZ*dtetaX_dx^2*dtetaZ_dx + tetaY*NtetaZ*dtetaX_dx^2*dtetaZ_dx + tetaY*tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaZ_dx + tetaY*tetaZ*dtetaX_dx^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*tetaZ*dtetaX_dx^2*dtetaY_dx + tetaY*NtetaZ*dtetaX_dx^2*dtetaY_dx + tetaY*tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx + tetaY*tetaZ*dtetaX_dx^2*dNtetaY_dx))/4;
%{
piR6Efuj05 = (NtetaZ.'*dtetaX_dx*dtetaY_dx*dtetaZ_dx^2 + dNtetaX_dx.'*tetaZ*dtetaY_dx*dtetaZ_dx^2 + dNtetaY_dx.'*tetaZ*dtetaX_dx*dtetaZ_dx^2 + 2*dtetaZ_dx*dNtetaZ_dx.'*tetaZ*dtetaX_dx*dtetaY_dx)/8 +...
     (2*tetaY*NtetaY.'*tetaZ*dtetaX_dx^3*dtetaY_dx + NtetaZ.'*tetaY^2*dtetaX_dx^3*dtetaY_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY^2*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaY^2*tetaZ*dtetaX_dx^3)/8 -...
     (NtetaY.'*tetaZ^2*dtetaX_dx^3*dtetaZ_dx + 2*tetaZ*NtetaZ.'*tetaY*dtetaX_dx^3*dtetaZ_dx + 3*dtetaX_dx^2*dNtetaX_dx.'*tetaY*tetaZ^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ^2*dtetaX_dx^3)/8 -...
     (NtetaY.'*tetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + NtetaZ.'*tetaY*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + 2*dtetaX_dx*dNtetaX_dx.'*tetaY*tetaZ*dtetaY_dx*dtetaZ_dx + dNtetaY_dx.'*tetaY*tetaZ*dtetaX_dx^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ*dtetaX_dx^2*dtetaY_dx)/4;
piR6Edfuj05Ref = jacobian(piR6Efuj05,uj);
erro = simplify(piR6Edfuj05Ref - piR6Edfuj05);
ad = 1;
%ok!
%}
%}
U_piR6E_dfuj = (dNtetaX_dx.'*3*dtetaX_dx^2*dNtetaX_dx)/3 +...
    (dNtetaY_dx.'*3*dtetaY_dx^2*dNtetaY_dx)/8 +...
    (dNtetaZ_dx.'*3*dtetaZ_dx^2*dNtetaZ_dx)/8 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^4 + tetaY*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*2*(3*dtetaX_dx^2*dNtetaX_dx*tetaY^2 + dtetaX_dx^3*2*tetaY*NtetaY))/6 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^4 + tetaZ*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*2*(3*dtetaX_dx^2*dNtetaX_dx*tetaZ^2 + dtetaX_dx^3*2*tetaZ*NtetaZ))/6 +...
    (NtetaY.'*(3*tetaY^2*NtetaY*dtetaX_dx^4 + tetaY^3*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*(3*dtetaX_dx^2*dNtetaX_dx*tetaY^4 + dtetaX_dx^3*4*tetaY^3*NtetaY))/8 +...
    (NtetaZ.'*(3*tetaZ^2*NtetaZ*dtetaX_dx^4 + tetaZ^3*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*(3*dtetaX_dx^2*dNtetaX_dx*tetaZ^4 + dtetaX_dx^3*4*tetaZ^3*NtetaZ))/8 +...
    (dNtetaX_dx.'*(dNtetaX_dx*dtetaY_dx^2 + dtetaX_dx*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*dtetaX_dx^2 + dtetaY_dx*2*dtetaX_dx*dNtetaX_dx))/6 +...
    (dNtetaX_dx.'*(dNtetaX_dx*dtetaZ_dx^2 + dtetaX_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*dtetaX_dx^2 + dtetaZ_dx*2*dtetaX_dx*dNtetaX_dx))/6 +...
    (dNtetaY_dx.'*(dNtetaY_dx*dtetaZ_dx^2 + dtetaY_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*dtetaY_dx^2 + dtetaZ_dx*2*dtetaY_dx*dNtetaY_dx))/8 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*dtetaY_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx^2 + tetaY*dtetaX_dx^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dtetaY_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dtetaY_dx^2 + dtetaX_dx*tetaY^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaY^2*dtetaX_dx^2 + dtetaY_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dtetaY_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))/8 +...
    (NtetaY.'*(NtetaY*dtetaX_dx^2*dtetaZ_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx*dtetaZ_dx^2 + tetaY*dtetaX_dx^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*dtetaZ_dx^2 + dtetaX_dx*2*tetaY*NtetaY*dtetaZ_dx^2 + dtetaX_dx*tetaY^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaY^2*dtetaX_dx^2 + dtetaZ_dx*2*tetaY*NtetaY*dtetaX_dx^2 + dtetaZ_dx*tetaY^2*2*dtetaX_dx*dNtetaX_dx))*(3/8) +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dtetaY_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx^2 + tetaZ*dtetaX_dx^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dtetaY_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dtetaY_dx^2 + dtetaX_dx*tetaZ^2*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaZ^2*dtetaX_dx^2 + dtetaY_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dtetaY_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))*(3/8) +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2*dtetaZ_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaZ_dx^2 + tetaZ*dtetaX_dx^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2*dtetaZ_dx^2 + dtetaX_dx*2*tetaZ*NtetaZ*dtetaZ_dx^2 + dtetaX_dx*tetaZ^2*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaZ^2*dtetaX_dx^2 + dtetaZ_dx*2*tetaZ*NtetaZ*dtetaX_dx^2 + dtetaZ_dx*tetaZ^2*2*dtetaX_dx*dNtetaX_dx))/8 +...
    (NtetaY.'*(NtetaY*tetaZ^2*dtetaX_dx^4 + tetaY*2*tetaZ*NtetaZ*dtetaX_dx^4 + tetaY*tetaZ^2*4*dtetaX_dx^3*dNtetaX_dx) +...
     NtetaZ.'*(NtetaZ*tetaY^2*dtetaX_dx^4 + tetaZ*2*tetaY*NtetaY*dtetaX_dx^4 + tetaZ*tetaY^2*4*dtetaX_dx^3*dNtetaX_dx) +...
     dNtetaX_dx.'*2*(3*dtetaX_dx^2*dNtetaX_dx*tetaY^2*tetaZ^2 + dtetaX_dx^3*2*tetaY*NtetaY*tetaZ^2 + dtetaX_dx^3*tetaY^2*2*tetaZ*NtetaZ))/8 -...
    (NtetaY.'*(3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + dtetaX_dx^3*dNtetaZ_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY*dtetaZ_dx + dtetaX_dx^2*NtetaY*dtetaZ_dx + dtetaX_dx^2*tetaY*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx^3 + tetaY*3*dtetaX_dx^2*dNtetaX_dx))/6 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx^3 + dtetaX_dx*3*dtetaZ_dx^2*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx^3 + tetaY*3*dtetaZ_dx^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*3*(2*dtetaZ_dx*dNtetaZ_dx*tetaY*dtetaX_dx + dtetaZ_dx^2*NtetaY*dtetaX_dx + dtetaZ_dx^2*tetaY*dNtetaX_dx))/8 +...
    (NtetaZ.'*(3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + dtetaX_dx^3*dNtetaY_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaZ*dtetaY_dx + dtetaX_dx^2*NtetaZ*dtetaY_dx + dtetaX_dx^2*tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx^3 + tetaZ*3*dtetaX_dx^2*dNtetaX_dx))/6 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx^3 + dtetaX_dx*3*dtetaY_dx^2*dNtetaY_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx^3 + tetaZ*3*dtetaY_dx^2*dNtetaY_dx) +...
     dNtetaY_dx.'*3*(2*dtetaY_dx*dNtetaY_dx*tetaZ*dtetaX_dx + dtetaY_dx^2*NtetaZ*dtetaX_dx + dtetaY_dx^2*tetaZ*dNtetaX_dx))/8 -...
    (NtetaY.'*3*(2*tetaY*NtetaY*dtetaX_dx^3*dtetaZ_dx + tetaY^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + tetaY^2*dtetaX_dx^3*dNtetaZ_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY^3*dtetaZ_dx + dtetaX_dx^2*3*tetaY^2*NtetaY*dtetaZ_dx + dtetaX_dx^2*tetaY^3*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(3*tetaY^2*NtetaY*dtetaX_dx^3 + tetaY^3*3*dtetaX_dx^2*dNtetaX_dx))/8 +...
    (NtetaZ.'*3*(2*tetaZ*NtetaZ*dtetaX_dx^3*dtetaY_dx + tetaZ^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + tetaZ^2*dtetaX_dx^3*dNtetaY_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaZ^3*dtetaY_dx + dtetaX_dx^2*3*tetaZ^2*NtetaZ*dtetaY_dx + dtetaX_dx^2*tetaZ^3*dNtetaY_dx) +...
     dNtetaY_dx.'*(3*tetaZ^2*NtetaZ*dtetaX_dx^3 + tetaZ^3*3*dtetaX_dx^2*dNtetaX_dx))/8 -...
    (NtetaY.'*(dNtetaX_dx*dtetaY_dx^2*dtetaZ_dx + dtetaX_dx*2*dtetaY_dx*dNtetaY_dx*dtetaZ_dx + dtetaX_dx*dtetaY_dx^2*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaY_dx^2*dtetaZ_dx + tetaY*2*dtetaY_dx*dNtetaY_dx*dtetaZ_dx + tetaY*dtetaY_dx^2*dNtetaZ_dx) +...
     dNtetaY_dx.'*2*(dNtetaY_dx*tetaY*dtetaX_dx*dtetaZ_dx + dtetaY_dx*NtetaY*dtetaX_dx*dtetaZ_dx + dtetaY_dx*tetaY*dNtetaX_dx*dtetaZ_dx + dtetaY_dx*tetaY*dtetaX_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx*dtetaY_dx^2 + tetaY*dNtetaX_dx*dtetaY_dx^2 + tetaY*dtetaX_dx*2*dtetaY_dx*dNtetaY_dx))/8 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx*dtetaZ_dx^2 + dtetaX_dx*dNtetaY_dx*dtetaZ_dx^2 + dtetaX_dx*dtetaY_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx*dtetaZ_dx^2 + tetaZ*dNtetaY_dx*dtetaZ_dx^2 + tetaZ*dtetaY_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx*dtetaZ_dx^2 + tetaZ*dNtetaX_dx*dtetaZ_dx^2 + tetaZ*dtetaX_dx*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*2*(dNtetaZ_dx*tetaZ*dtetaX_dx*dtetaY_dx + dtetaZ_dx*NtetaZ*dtetaX_dx*dtetaY_dx + dtetaZ_dx*tetaZ*dNtetaX_dx*dtetaY_dx + dtetaZ_dx*tetaZ*dtetaX_dx*dNtetaY_dx))/8 +...
    (NtetaY.'*2*(NtetaY*tetaZ*dtetaX_dx^3*dtetaY_dx + tetaY*NtetaZ*dtetaX_dx^3*dtetaY_dx + tetaY*tetaZ*3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + tetaY*tetaZ*dtetaX_dx^3*dNtetaY_dx) +...
     NtetaZ.'*(2*tetaY*NtetaY*dtetaX_dx^3*dtetaY_dx + tetaY^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaY_dx + tetaY^2*dtetaX_dx^3*dNtetaY_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY^2*tetaZ*dtetaY_dx + dtetaX_dx^2*2*tetaY*NtetaY*tetaZ*dtetaY_dx + dtetaX_dx^2*tetaY^2*NtetaZ*dtetaY_dx + dtetaX_dx^2*tetaY^2*tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(2*tetaY*NtetaY*tetaZ*dtetaX_dx^3 + tetaY^2*NtetaZ*dtetaX_dx^3 + tetaY^2*tetaZ*3*dtetaX_dx^2*dNtetaX_dx))/8 -...
    (NtetaY.'*(2*tetaZ*NtetaZ*dtetaX_dx^3*dtetaZ_dx + tetaZ^2*3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + tetaZ^2*dtetaX_dx^3*dNtetaZ_dx) +...
     NtetaZ.'*2*(NtetaZ*tetaY*dtetaX_dx^3*dtetaZ_dx + tetaZ*NtetaY*dtetaX_dx^3*dtetaZ_dx + tetaZ*tetaY*3*dtetaX_dx^2*dNtetaX_dx*dtetaZ_dx + tetaZ*tetaY*dtetaX_dx^3*dNtetaZ_dx) +...
     dNtetaX_dx.'*3*(2*dtetaX_dx*dNtetaX_dx*tetaY*tetaZ^2*dtetaZ_dx + dtetaX_dx^2*NtetaY*tetaZ^2*dtetaZ_dx + dtetaX_dx^2*tetaY*2*tetaZ*NtetaZ*dtetaZ_dx + dtetaX_dx^2*tetaY*tetaZ^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*tetaZ^2*dtetaX_dx^3 + tetaY*2*tetaZ*NtetaZ*dtetaX_dx^3 + tetaY*tetaZ^2*3*dtetaX_dx^2*dNtetaX_dx))/8 -...
    (NtetaY.'*(NtetaZ*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx*dtetaZ_dx + tetaZ*dtetaX_dx^2*dNtetaY_dx*dtetaZ_dx + tetaZ*dtetaX_dx^2*dtetaY_dx*dNtetaZ_dx) +...
     NtetaZ.'*(NtetaY*dtetaX_dx^2*dtetaY_dx*dtetaZ_dx + tetaY*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx*dtetaZ_dx + tetaY*dtetaX_dx^2*dNtetaY_dx*dtetaZ_dx + tetaY*dtetaX_dx^2*dtetaY_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*2*(dNtetaX_dx*tetaY*tetaZ*dtetaY_dx*dtetaZ_dx + dtetaX_dx*NtetaY*tetaZ*dtetaY_dx*dtetaZ_dx + dtetaX_dx*tetaY*NtetaZ*dtetaY_dx*dtetaZ_dx + dtetaX_dx*tetaY*tetaZ*dNtetaY_dx*dtetaZ_dx + dtetaX_dx*tetaY*tetaZ*dtetaY_dx*dNtetaZ_dx) +...
     dNtetaY_dx.'*(NtetaY*tetaZ*dtetaX_dx^2*dtetaZ_dx + tetaY*NtetaZ*dtetaX_dx^2*dtetaZ_dx + tetaY*tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaZ_dx + tetaY*tetaZ*dtetaX_dx^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*tetaZ*dtetaX_dx^2*dtetaY_dx + tetaY*NtetaZ*dtetaX_dx^2*dtetaY_dx + tetaY*tetaZ*2*dtetaX_dx*dNtetaX_dx*dtetaY_dx + tetaY*tetaZ*dtetaX_dx^2*dNtetaY_dx))/4;
%{
U_piR6E_dfujRef = jacobian(U_piR6E_fuj,uj);
erro = simplify(U_piR6E_dfujRef - U_piR6E_dfuj);
ad = 1;
%ok!
%}
%%
U_piR2ksG_dfuj = (NtetaY.'*2*(NtetaY*du_dx + tetaY*dNu_dx) +...
     dNu_dx.'*2*tetaY*NtetaY)*2 +...
    (NtetaZ.'*2*(NtetaZ*du_dx + tetaZ*dNu_dx) +...
     dNu_dx.'*2*tetaZ*NtetaZ)*2 +...
    (NtetaY.'*2*(NtetaY*du_dx^2 + tetaY*2*du_dx*dNu_dx) +...
     dNu_dx.'*2*(dNu_dx*tetaY^2 + du_dx*2*tetaY*NtetaY)) +...
    (NtetaZ.'*2*(NtetaZ*du_dx^2 + tetaZ*2*du_dx*dNu_dx) +...
     dNu_dx.'*2*(dNu_dx*tetaZ^2 + du_dx*2*tetaZ*NtetaZ)) -...
    (NtetaZ.'*(dNu_dx*dv_dx + du_dx*dNv_dx) +...
     dNu_dx.'*(NtetaZ*dv_dx + tetaZ*dNv_dx) +...
     dNv_dx.'*(NtetaZ*du_dx + tetaZ*dNu_dx))*2 +...
    (NtetaY.'*(dNu_dx*dw_dx + du_dx*dNw_dx) +...
     dNu_dx.'*(NtetaY*dw_dx + tetaY*dNw_dx) +...
     dNw_dx.'*(NtetaY*du_dx + tetaY*dNu_dx))*2;
%{
U_piR2ksG_dfujRef = jacobian(U_piR2ksG_fuj,uj);
erro = simplify(U_piR2ksG_dfujRef - U_piR2ksG_dfuj);
ad = 1;
%ok!
%}
%%
%{
piR4ksGfuj01 = (tetaY*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2) +...
     (tetaY*NtetaY.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2) +...
     (tetaY*NtetaY.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaZ^2)/2;
piR4ksGfuj02 = (2*tetaY^3*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^4)/2 +...
     (tetaZ*NtetaZ.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaZ^2)/2 +...
     (2*tetaZ^3*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^4)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx)/2 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx)/2;
piR4ksGfuj03 = (tetaY*NtetaY.'*tetaZ^2*dtetaX_dx^2 + tetaZ*NtetaZ.'*tetaY^2*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*tetaZ^2) -...
     (3*tetaY^2*NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY^3*dtetaZ_dx + dNtetaZ_dx.'*tetaY^3*dtetaX_dx)/2 +...
     (3*tetaZ^2*NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ^3*dtetaY_dx + dNtetaY_dx.'*tetaZ^3*dtetaX_dx)/2 +...
     (2*tetaY*NtetaY.'*tetaZ*dtetaX_dx*dtetaY_dx + NtetaZ.'*tetaY^2*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaY^2*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaY^2*tetaZ*dtetaX_dx)/2 -...
     (NtetaY.'*tetaZ^2*dtetaX_dx*dtetaZ_dx + 2*tetaZ*NtetaZ.'*tetaY*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*tetaZ^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ^2*dtetaX_dx)/2;
%{
erro = simplify(U_piR4ksG_fuj - (piR4ksGfuj01 + piR4ksGfuj02 + piR4ksGfuj03));
ad = 1;
%ok!
%}
%}
%{
piR4ksGdfuj01 = (NtetaY.'*(NtetaY*dtetaX_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2 + dtetaX_dx*2*tetaY*NtetaY)) +...
    (NtetaY.'*(NtetaY*dtetaY_dx^2 + tetaY*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaY^2 + dtetaY_dx*2*tetaY*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2 + dtetaX_dx*2*tetaZ*NtetaZ)) +...
    (NtetaY.'*(NtetaY*dtetaZ_dx^2 + tetaY*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaY^2 + dtetaZ_dx*2*tetaY*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaY_dx^2 + tetaZ*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaZ^2 + dtetaY_dx*2*tetaZ*NtetaZ))/2;
%{
piR4ksGfuj01 = (tetaY*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2) +...
     (tetaY*NtetaY.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^2) +...
     (tetaY*NtetaY.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaY^2)/2 +...
     (tetaZ*NtetaZ.'*dtetaY_dx^2 + dtetaY_dx*dNtetaY_dx.'*tetaZ^2)/2;
piR4ksGdfuj01Ref = jacobian(piR4ksGfuj01,uj);
erro = simplify(piR4ksGdfuj01Ref - piR4ksGdfuj01);
ad = 1;
%ok!
%}
piR4ksGdfuj02 = (NtetaY.'*2*(3*tetaY^2*NtetaY*dtetaX_dx^2 + tetaY^3*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^4 + dtetaX_dx*4*tetaY^3*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaZ_dx^2 + tetaZ*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaZ^2 + dtetaZ_dx*2*tetaZ*NtetaZ))/2 +...
    (NtetaZ.'*2*(3*tetaZ^2*NtetaZ*dtetaX_dx^2 + tetaZ^3*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^4 + dtetaX_dx*4*tetaZ^3*NtetaZ))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx + dtetaX_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx + tetaY*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx + tetaY*dNtetaX_dx))/2 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx + dtetaX_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx + tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx + tetaZ*dNtetaX_dx))/2;
%{
piR4ksGfuj02 = (2*tetaY^3*NtetaY.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^4)/2 +...
     (tetaZ*NtetaZ.'*dtetaZ_dx^2 + dtetaZ_dx*dNtetaZ_dx.'*tetaZ^2)/2 +...
     (2*tetaZ^3*NtetaZ.'*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaZ^4)/2 -...
     (NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*dtetaZ_dx + dNtetaZ_dx.'*tetaY*dtetaX_dx)/2 +...
     (NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaZ*dtetaX_dx)/2;
piR4ksGdfuj02Ref = jacobian(piR4ksGfuj02,uj);
erro = simplify(piR4ksGdfuj02Ref - piR4ksGdfuj02);
ad = 1;
%ok!
%}
piR4ksGdfuj03 = (NtetaY.'*(NtetaY*tetaZ^2*dtetaX_dx^2 + tetaY*2*tetaZ*NtetaZ*dtetaX_dx^2 + tetaY*tetaZ^2*2*dtetaX_dx*dNtetaX_dx) +...
     NtetaZ.'*(NtetaZ*tetaY^2*dtetaX_dx^2 + tetaZ*2*tetaY*NtetaY*dtetaX_dx^2 + tetaZ*tetaY^2*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*tetaZ^2 + dtetaX_dx*2*tetaY*NtetaY*tetaZ^2 + dtetaX_dx*tetaY^2*2*tetaZ*NtetaZ)) -...
    (NtetaY.'*3*(2*tetaY*NtetaY*dtetaX_dx*dtetaZ_dx + tetaY^2*dNtetaX_dx*dtetaZ_dx + tetaY^2*dtetaX_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(3*tetaY^2*NtetaY*dtetaZ_dx + tetaY^3*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(3*tetaY^2*NtetaY*dtetaX_dx + tetaY^3*dNtetaX_dx))/2 +...
    (NtetaZ.'*3*(2*tetaZ*NtetaZ*dtetaX_dx*dtetaY_dx + tetaZ^2*dNtetaX_dx*dtetaY_dx + tetaZ^2*dtetaX_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(3*tetaZ^2*NtetaZ*dtetaY_dx + tetaZ^3*dNtetaY_dx) +...
     dNtetaY_dx.'*(3*tetaZ^2*NtetaZ*dtetaX_dx + tetaZ^3*dNtetaX_dx))/2 +...
    (NtetaY.'*2*(NtetaY*tetaZ*dtetaX_dx*dtetaY_dx + tetaY*NtetaZ*dtetaX_dx*dtetaY_dx + tetaY*tetaZ*dNtetaX_dx*dtetaY_dx + tetaY*tetaZ*dtetaX_dx*dNtetaY_dx) +...
     NtetaZ.'*(2*tetaY*NtetaY*dtetaX_dx*dtetaY_dx + tetaY^2*dNtetaX_dx*dtetaY_dx + tetaY^2*dtetaX_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(2*tetaY*NtetaY*tetaZ*dtetaY_dx + tetaY^2*NtetaZ*dtetaY_dx + tetaY^2*tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(2*tetaY*NtetaY*tetaZ*dtetaX_dx + tetaY^2*NtetaZ*dtetaX_dx + tetaY^2*tetaZ*dNtetaX_dx))/2 -...
    (NtetaY.'*(2*tetaZ*NtetaZ*dtetaX_dx*dtetaZ_dx + tetaZ^2*dNtetaX_dx*dtetaZ_dx + tetaZ^2*dtetaX_dx*dNtetaZ_dx) +...
     NtetaZ.'*2*(NtetaZ*tetaY*dtetaX_dx*dtetaZ_dx + tetaZ*NtetaY*dtetaX_dx*dtetaZ_dx + tetaZ*tetaY*dNtetaX_dx*dtetaZ_dx + tetaZ*tetaY*dtetaX_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*tetaZ^2*dtetaZ_dx + tetaY*2*tetaZ*NtetaZ*dtetaZ_dx + tetaY*tetaZ^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*tetaZ^2*dtetaX_dx + tetaY*2*tetaZ*NtetaZ*dtetaX_dx + tetaY*tetaZ^2*dNtetaX_dx))/2;
%{
piR4ksGfuj03 = (tetaY*NtetaY.'*tetaZ^2*dtetaX_dx^2 + tetaZ*NtetaZ.'*tetaY^2*dtetaX_dx^2 + dtetaX_dx*dNtetaX_dx.'*tetaY^2*tetaZ^2) -...
     (3*tetaY^2*NtetaY.'*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY^3*dtetaZ_dx + dNtetaZ_dx.'*tetaY^3*dtetaX_dx)/2 +...
     (3*tetaZ^2*NtetaZ.'*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaZ^3*dtetaY_dx + dNtetaY_dx.'*tetaZ^3*dtetaX_dx)/2 +...
     (2*tetaY*NtetaY.'*tetaZ*dtetaX_dx*dtetaY_dx + NtetaZ.'*tetaY^2*dtetaX_dx*dtetaY_dx + dNtetaX_dx.'*tetaY^2*tetaZ*dtetaY_dx + dNtetaY_dx.'*tetaY^2*tetaZ*dtetaX_dx)/2 -...
     (NtetaY.'*tetaZ^2*dtetaX_dx*dtetaZ_dx + 2*tetaZ*NtetaZ.'*tetaY*dtetaX_dx*dtetaZ_dx + dNtetaX_dx.'*tetaY*tetaZ^2*dtetaZ_dx + dNtetaZ_dx.'*tetaY*tetaZ^2*dtetaX_dx)/2;
piR4ksGdfuj03Ref = jacobian(piR4ksGfuj03,uj);
erro = simplify(piR4ksGdfuj03Ref - piR4ksGdfuj03);
ad = 1;
%ok!
%}
%}
U_piR4ksG_dfuj = (NtetaY.'*(NtetaY*dtetaX_dx^2 + tetaY*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2 + dtetaX_dx*2*tetaY*NtetaY)) +...
    (NtetaY.'*(NtetaY*dtetaY_dx^2 + tetaY*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaY^2 + dtetaY_dx*2*tetaY*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaX_dx^2 + tetaZ*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^2 + dtetaX_dx*2*tetaZ*NtetaZ)) +...
    (NtetaY.'*(NtetaY*dtetaZ_dx^2 + tetaY*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaY^2 + dtetaZ_dx*2*tetaY*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaY_dx^2 + tetaZ*2*dtetaY_dx*dNtetaY_dx) +...
     dNtetaY_dx.'*(dNtetaY_dx*tetaZ^2 + dtetaY_dx*2*tetaZ*NtetaZ))/2 +...
    (NtetaY.'*2*(3*tetaY^2*NtetaY*dtetaX_dx^2 + tetaY^3*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^4 + dtetaX_dx*4*tetaY^3*NtetaY))/2 +...
    (NtetaZ.'*(NtetaZ*dtetaZ_dx^2 + tetaZ*2*dtetaZ_dx*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(dNtetaZ_dx*tetaZ^2 + dtetaZ_dx*2*tetaZ*NtetaZ))/2 +...
    (NtetaZ.'*2*(3*tetaZ^2*NtetaZ*dtetaX_dx^2 + tetaZ^3*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaZ^4 + dtetaX_dx*4*tetaZ^3*NtetaZ))/2 -...
    (NtetaY.'*(dNtetaX_dx*dtetaZ_dx + dtetaX_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*dtetaZ_dx + tetaY*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*dtetaX_dx + tetaY*dNtetaX_dx))/2 +...
    (NtetaZ.'*(dNtetaX_dx*dtetaY_dx + dtetaX_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(NtetaZ*dtetaY_dx + tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(NtetaZ*dtetaX_dx + tetaZ*dNtetaX_dx))/2 +...
    (NtetaY.'*(NtetaY*tetaZ^2*dtetaX_dx^2 + tetaY*2*tetaZ*NtetaZ*dtetaX_dx^2 + tetaY*tetaZ^2*2*dtetaX_dx*dNtetaX_dx) +...
     NtetaZ.'*(NtetaZ*tetaY^2*dtetaX_dx^2 + tetaZ*2*tetaY*NtetaY*dtetaX_dx^2 + tetaZ*tetaY^2*2*dtetaX_dx*dNtetaX_dx) +...
     dNtetaX_dx.'*(dNtetaX_dx*tetaY^2*tetaZ^2 + dtetaX_dx*2*tetaY*NtetaY*tetaZ^2 + dtetaX_dx*tetaY^2*2*tetaZ*NtetaZ)) -...
    (NtetaY.'*3*(2*tetaY*NtetaY*dtetaX_dx*dtetaZ_dx + tetaY^2*dNtetaX_dx*dtetaZ_dx + tetaY^2*dtetaX_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(3*tetaY^2*NtetaY*dtetaZ_dx + tetaY^3*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(3*tetaY^2*NtetaY*dtetaX_dx + tetaY^3*dNtetaX_dx))/2 +...
    (NtetaZ.'*3*(2*tetaZ*NtetaZ*dtetaX_dx*dtetaY_dx + tetaZ^2*dNtetaX_dx*dtetaY_dx + tetaZ^2*dtetaX_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(3*tetaZ^2*NtetaZ*dtetaY_dx + tetaZ^3*dNtetaY_dx) +...
     dNtetaY_dx.'*(3*tetaZ^2*NtetaZ*dtetaX_dx + tetaZ^3*dNtetaX_dx))/2 +...
    (NtetaY.'*2*(NtetaY*tetaZ*dtetaX_dx*dtetaY_dx + tetaY*NtetaZ*dtetaX_dx*dtetaY_dx + tetaY*tetaZ*dNtetaX_dx*dtetaY_dx + tetaY*tetaZ*dtetaX_dx*dNtetaY_dx) +...
     NtetaZ.'*(2*tetaY*NtetaY*dtetaX_dx*dtetaY_dx + tetaY^2*dNtetaX_dx*dtetaY_dx + tetaY^2*dtetaX_dx*dNtetaY_dx) +...
     dNtetaX_dx.'*(2*tetaY*NtetaY*tetaZ*dtetaY_dx + tetaY^2*NtetaZ*dtetaY_dx + tetaY^2*tetaZ*dNtetaY_dx) +...
     dNtetaY_dx.'*(2*tetaY*NtetaY*tetaZ*dtetaX_dx + tetaY^2*NtetaZ*dtetaX_dx + tetaY^2*tetaZ*dNtetaX_dx))/2 -...
    (NtetaY.'*(2*tetaZ*NtetaZ*dtetaX_dx*dtetaZ_dx + tetaZ^2*dNtetaX_dx*dtetaZ_dx + tetaZ^2*dtetaX_dx*dNtetaZ_dx) +...
     NtetaZ.'*2*(NtetaZ*tetaY*dtetaX_dx*dtetaZ_dx + tetaZ*NtetaY*dtetaX_dx*dtetaZ_dx + tetaZ*tetaY*dNtetaX_dx*dtetaZ_dx + tetaZ*tetaY*dtetaX_dx*dNtetaZ_dx) +...
     dNtetaX_dx.'*(NtetaY*tetaZ^2*dtetaZ_dx + tetaY*2*tetaZ*NtetaZ*dtetaZ_dx + tetaY*tetaZ^2*dNtetaZ_dx) +...
     dNtetaZ_dx.'*(NtetaY*tetaZ^2*dtetaX_dx + tetaY*2*tetaZ*NtetaZ*dtetaX_dx + tetaY*tetaZ^2*dNtetaX_dx))/2;
%{
U_piR4ksG_dfujRef = jacobian(U_piR4ksG_fuj,uj);
erro = simplify(U_piR4ksG_dfujRef - U_piR4ksG_dfuj);
ad = 1;
%ok!
%}

U_dfujdujT_Aux = pi*R^2*E*U_piR2E_dfuj +...
    pi*R^4*E*U_piR4E_dfuj +...
    pi*R^6*E*U_piR6E_dfuj +...
    pi*R^2*ks*G*U_piR2ksG_dfuj +...
    pi*R^4*ks*G*U_piR4ksG_dfuj;
%{
U_dfujdujT_Aux_ref = jacobian(U_fuj_Aux,uj);
disp('ping_dU_fuj_Aux_dujT')
erro_dU_fuj_Aux_dujT = simplify(U_dfujdujT_Aux_ref - U_dfujdujT_Aux);
disp('pong_dU_fuj_Aux_dujT')
ad = 1;
%ok!
%}



